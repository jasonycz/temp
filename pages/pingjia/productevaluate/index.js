window.define("pages/pingjia/productevaluate/index",function(a,e,t,i,n,s,u,o,d,r,p,g,l,c,m,y){"use strict";var v=a("../../../network/api"),h=function(a){return a&&a.__esModule?a:{default:a}}(v);Page({data:{query:{pageNo:1,pageSize:5,status:-1,sType:""},pingjiaArray:[{name:"全部",num:0,type:"reviewsNum"},{name:"好评",num:0,type:"goodReviewsNum"},{name:"中评",num:0,type:"middleReviewsNum"},{name:"差评",num:0,type:"badReviewsNum"},{name:"有图",num:0,type:"imgReviewsNum"}]},onLoad:function(a){var e=this;this.setData({"query.sType":a.sType,"query.sid":a.sid,"query.storeId":a.storeId}),this.queryEvaluateList(this.data.query,!0),this.setData({pingjiaArray:this.data.pingjiaArray.map(function(a){return Object.assign({},a,{num:e.data.evaluateData[""+a.type]})})})},queryEvaluateList:function(a,e){var t=this;n.showLoading({title:"请稍后"}),h.default.queryEvaluateList(a).then(function(a){n.hideLoading(),t.setData({evaluateData:e?a.data:Object.assign({},t.data.evaluateData,{data:t.data.evaluateData.data.concat(a.data.data)}),loadmore:a.data.nextCursor>0,loadingmore:!1,query:Object.assign({},t.data.query,{pageNo:a.data.nextCursor,pageSize:a.data.pageSize}),isShow:!0,scrollTop:e?0:void 0,pingjiaArray:t.data.pingjiaArray.map(function(e){return Object.assign({},e,{num:a.data[""+e.type]})})})}).catch(function(a){return console.log(a)})},lower:function(a){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryEvaluateList(Object.assign({},this.data.query),!1))},evaluateTab:function(a){var e=a.detail,t=(e.currentType,e.evaluate);console.log(a.detail,"........................."),this.setData({"query.status":t}),this.queryEvaluateList(Object.assign({},this.data.query,{pageNo:1}),!0)}}),Page({})}),window.__swanRoute="pages/pingjia/productevaluate/index",window.usingComponents=["pages/pingjia/component/evaluatecontent/index","pages/pingjia/component/evaluateitems/index","dist/minui/wxc-abnor/dist/index","pages/pingjia/productevaluate/index"],require("pages/pingjia/productevaluate/index");