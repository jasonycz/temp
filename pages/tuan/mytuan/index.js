window.define("pages/tuan/mytuan/index",function(t,a,e,n,i,o,s,u,r,d,l,m,c,h,g,f){"use strict";function y(t){return t&&t.__esModule?t:{default:t}}function L(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var p=t("../../../network/api.js"),w=y(p),T=t("../../../utils/util.js"),q=y(T);Page({data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:10}},onLoad:function(t){this.queryMyTuanList(this.data.query,!0)},startCount:function(){var t=this,a=this,e=this.data.mytuanList,n=void 0===e?[]:e;n.forEach(function(a,e){t.setData(L({},"mytuanList["+e+"].leftTime",q.default.renderTimer(a.remainTime)))}),n.length>0&&(this.stopCount(),this.timer=setInterval(function(){n.forEach(function(t,e){var n,i=t.remainTime-1;0==i&&a.setData(L({},"mytuanList["+e+"].status",3)),a.setData((n={},L(n,"mytuanList["+e+"].remainTime",i),L(n,"mytuanList["+e+"].leftTime",q.default.renderTimer(i)),n))})},1e3))},stopCount:function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},onUnload:function(){this.stopCount()},queryMyTuanList:function(t,a){var e=this;i.showLoading({title:"请稍后"}),w.default.queryMyTuanList(t).then(function(t){console.log(t,"++++"),i.hideLoading(),e.setData({mytuanList:a?t.data.data:e.data.mytuanList.concat(t.data.data),loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},e.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}),isShow:!0}),console.log(t,"++++++++++++"),e.startCount()}).catch(function(t){console.log(t),i.hideLoading()})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryMyTuanList(Object.assign({},this.data.query),!1))}})}),window.__swanRoute="pages/tuan/mytuan/index",window.usingComponents=[],require("pages/tuan/mytuan/index");