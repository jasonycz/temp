window.define("tabs/home/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../network/api.js"),y=m(w),v=t("../../utils/const.js"),D=m(v),x=t("../../utils/notification"),b=m(x),T=t("../../utils/location.js"),C=m(T);Page({data:{locationSuccess:!0,activityCards:[],storeType:""},onLoad:function(t){this.registeNotification();var e=n().globalData.editionType;this.init(),this.setData({code:t.scene||"",storeType:e})},onShow:function(){},onHide:function(){var t=this.data,e=t.activityCards,a=t.tabName,o=t.activityIndex;o<e.length-1?i.setStorageSync("activity",{activityCards:e,tabName:a,activityIndex:o}):i.setStorageSync("activity",{})},onShareAppMessage:function(t){var e=n().globalData.userinfo;t.from,t.target;return{imageUrl:this.data.shareImg,title:this.data.desc||this.data.title,path:"/tabs/home/index?shareCode="+e.shareCode}},onUnload:function(){this.removeNotification()},init:function(){var t=this,e=n().globalConfig;e&&(this.setData(Object.assign({},this.data,{globalConfig:e})),e.isEnableLocation?(i.showLoading({title:"定位中..."}),C.default.ensureLocation(e).then(function(){}).catch(function(e){console.log(e),t.setData({locationSuccess:!1}),i.stopPullDownRefresh(),i.hideLoading()})):this.queryData())},queryData:function(){var t=this;i.showLoading({title:"请稍候"}),y.default.init().then(function(e){t.setData(Object.assign({},e.data,{serverTime:e.serverTime})),i.stopPullDownRefresh(),i.hideLoading()}).catch(function(t){console.log(t),i.stopPullDownRefresh(),i.hideLoading()})},onPullDownRefresh:function(){var t=this.data,e=t.globalConfig,a=t.location;1==e.locationType?this.init():a&&a.location?this.queryData():this.init()},registeNotification:function(){var t=this;b.default.register(D.default.action.QUERY_CONFIG_SUCCESS,this,function(){t.init()}),b.default.register(D.default.action.LOCATION_CHANGED,this,function(e){console.log("location_changed",e.data),t.setData({location:e.data,locationSuccess:!0}),t.queryData()}),b.default.register(D.default.action.GOTO_SHOP,this,function(t){console.log("get notif从订单页面跳转到店铺首页",t),i.navigateTo({url:"/pages/shop/products/products?storeid="+t.data.storeId})})},removeNotification:function(){b.default.remove(D.default.action.QUERY_CONFIG_SUCCESS,this),b.default.remove(D.default.action.LOCATION_CHANGED,this),b.default.remove(D.default.action.GOTO_SHOP,this)},handlePhoneBtnTap:function(t){var e=t.currentTarget.dataset.phone,a=e.telephone,o=e.cellphone,i=e.extNum,n=[];a&&(i?n.push(a+"转"+i):n.push(a)),o&&n.push(o),this.setData({phoneList:n});var s=this.selectComponent(".phoneaction");s&&s.show()},handleChooseAddress:function(){var t=this.data,e=t.globalConfig,a=t.location,o=t.storeType,n=void 0;n=0==e.locationType||"mall"==o?"/pages/citys/citys":"/pages/addressdetail/addressdetail?addressid="+(a?a.addressId:""),i.navigateTo({url:n})},queryActivity:function(t,e){var a=this;y.default.queryActivity({scene:t,code:e}).then(function(t){if(t&&t.data&&t.data.list){var e=[];if(t.data.list.forEach(function(t){5===t.status&&(t.VIPCardList&&t.VIPCardList.length&&e.push({name:"card",data:t.VIPCardList}),t.couponList&&t.couponList.length&&e.push({name:"coupon",data:t.couponList.map(function(t){return t.useTime=t.useTime.substring(0,11),t.useEndTime=t.useEndTime.substring(0,11),t})}),t.giftCardList&&t.giftCardList.length&&e.push({name:"gift",data:t.giftCardList}),t.point&&e.push({name:"score",data:{score:t.point}}),"smyl"===t.type&&(t.VIPCardList&&t.VIPCardList.length||t.couponList&&t.couponList.length||t.giftCardList&&t.giftCardList.length||t.point)&&e.push({name:"share",data:t.share}))}),e.length)a.setData({activityCards:e,tabName:t.data.myName,activityIndex:0}),a.showGiftPopup();else{var o=a.data,n=o.activityCards;if(o.activityIndex<n.length-1)return;var s=i.getStorageSync("activity");s.activityCards&&s.activityCards.length&&(a.setData({activityCards:s.activityCards,tabName:s.tabName,activityIndex:s.activityIndex}),a.showGiftPopup())}}}).catch(function(t){console.log("---err---",t)})},showGiftPopup:function(){var t=this.selectComponent(".home_gift_popup");t&&t.show()},hideGiftPopup:function(){var t=this.selectComponent(".home_gift_popup");t&&t.hide()},updateindex:function(t){this.setData({activityIndex:t.detail.index})}})}),window.define("tabs/mine/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var y=t("../../utils/util"),v=m(y),D=t("../../network/api"),x=m(D),b=t("../../utils/const.js"),T=m(b),C=t("../../utils/notification.js"),S=m(C),L=t("../../dist/index"),_=m(L),k={data:{isShow:!1,order:{}}};v.default.registComp(k,_.default.Toast,{onShareAppMessage:function(){return{path:"/tabs/home/index?shareCode="+n().globalData.userinfo.shareCode}},onLoad:function(){i.showLoading({title:"加载中"});var t=n().globalData.color;this.setData({color:t})},onShow:function(){var t=this,e=i.getExtConfigSync();console.log("ext",e);var a=i.getStorageSync("userinfo");console.log(a,"++++++++++++++++++++++++"),this.setData({userInfo:a}),this.updateUser(),this.queryMine(),x.default.getStaticticsOrderNum().then(function(e){e&&e.data&&e.data.forEach(function(e){t.setData(w({},"order["+e.orderStatus+"]",e.num))})})},updateUser:function(){var t=this;i.getStorageSync("userUpdated")?this.lookup():i.getUserInfo({success:function(e){x.default.updateWXUserInfo(e.userInfo).then(function(){i.setStorageSync("userUpdated","yes"),t.lookup()})},fail:function(){t.lookup()}})},lookup:function(){var t=this,e=this;x.default.queryUserInfo().then(function(a){if(i.stopPullDownRefresh(),console.log("bingooooooooooooo",a),i.hideLoading(),i.setStorageSync("userinfo",a.data),e.setData({userInfo:a.data}),a.data&&a.data.mobile){console.log(" res.data---\x3e",a.data);var o=a.data.mobile.substring(0,3)+"****"+a.data.mobile.substr(7,10);t.setData({mobile:o,"userInfo.mobileHidden":o})}}).catch(function(t){return console.log(t)})},logout:function(){var t=this;i.showLoading({title:"加载中"}),x.default.logout().then(function(e){i.stopPullDownRefresh(),console.log("bingooooooooooooo",e),e.data.result&&t.lookup()}).catch(function(t){return console.log(t)})},showToast:function(t){this.showZanToast(t)},queryMine:function(){var t=this,e={sign:"profile"};x.default.getIndexMenu(e).then(function(e){i.stopPullDownRefresh(),console.log("bingooooooooooooo",e),i.hideLoading(),t.setData({mine:e.data.options,isShow:!0}),t.genMenu(e.data.options)}).catch(function(t){return console.log(t)})},genMenu:function(t){var e=[];1==t.balanceIsShow&&e.push({type:"balance",title:"我的余额",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/1120/balance.png",url:"/pages/storevalue/mybalance/index"}),1==t.collectionIsShow&&e.push({type:"collection",title:"我的收藏",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/1120/mine-collection.png",url:"/pages/mine/collection/index"}),1==t.couponIsShow&&e.push({type:"coupon",title:"优惠券",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/coupon.png",url:"/pages/mine/coupons/coupons"}),1==t.cardIsShow&&e.push({type:"card",title:"会员卡",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/card.png",url:"/pages/mine/cards/cards"}),1==t.pointsIsShow&&e.push({type:"score",title:"我的积分",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/score.png",url:"/pages/mine/scores/scores"}),1==t.giftCardShow&&e.push({type:"giftcard",title:"我的礼品卡",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/giftcards.png",url:"/pages/giftcard/mygiftcard/index"}),1==t.yuyueIsShow&&e.push({type:"yuyue",title:"我的预约",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/yuyue.png",url:"/pages/services/orders/index"}),1==t.evaluateIsShow&&e.push({type:"evaluate",title:"我的评价",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/1120/evaluate.png",url:"/pages/pingjia/myevaluate/index?sType=8"}),1==t.distributionIsShow&&e.push({type:"fenxiao",title:t.distributionName,icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/fenxiao.png",url:"/pages/fenxiao/center/index"}),1==t.distributionGoodsIsShow&&e.push({type:"fenxiaoGoods",title:"分销商品库",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/fenxiaogoods.png",url:"/pages/fenxiao/products/index?type=mylist"}),1==t.fightGroupShow&&e.push({type:"tuan",title:"我的拼团",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/tuan.png",url:"/pages/tuan/mytuan/index"}),1==t.hotelIsShow&&e.push({type:"hotel",title:"我的酒店",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/hotel.png",url:"/pages/hotel/orders/index"}),1==t.foodIsShow&&e.push({type:"food",title:"我的餐饮",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/food.png",url:"/pages/food/myfood/index"}),1==t.timesCardIsShow&&e.push({type:"timescard",title:"次卡",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/timescard-icon.png",url:"/pages/car/my/index"}),1==t.carProjectIsShow&&e.push({type:"carprojectorders",title:"汽车服务",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/carservice-icon.png",url:"/pages/car/projectorders/index"}),1==t.supplyShow&&e.push({type:"supply",title:"我的供求",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/supply.png",url:"/pages/gongqiu/mygongqiu/index"}),1==t.liveIsShow&&e.push({type:"live",title:"我的直播",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/live/mylive.png",url:"/pages/live/favorites/index"}),1==t.courseShow&&e.push({type:"courseShow",title:"我的课程",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/course.png",url:"/pages/edu/favorites/index"}),t.online&&1==t.online.isShow&&e.push({type:"contact",title:"客服",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/contact.png"}),t.link&&1==t.link.isShow&&e.push({type:"phone",title:"电话",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/phone.png",bindtap:"makephone"}),t.about&&1==t.about.isShow&&e.push({type:"about",title:"关于我们",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/about.png",bindtap:"makeabout"}),1==t.bargainIsShow&&e.push({type:"bargainIsShow",title:"我的砍价",icon:"http://imgcdnali.wfenxiao.com.cn/xcx/c/sicons/cutprice.png",url:"/pages/mine/cutprice/index"}),this.setData({menus:e})},makephone:function(){var t=this.data.mine.link,e=t.telephone,a=t.phone,o=t.extNum;console.log(this.data.mine.link,"kkkkkkkkkkkkkkkkkk");var n=[];if(e&&(o?n.push(e+"转"+o):n.push(e)),a&&n.push(a),n.length>0){this.setData({phoneList:n});var s=this.selectComponent(".phoneaction");s&&s.show()}else i.makePhoneCall({phoneNumber:n[0]})},makeabout:function(){i.navigateTo({url:"/pages/aboutmine/aboutmine?aboutmine="+JSON.stringify(this.data.mine.about)})},handleLogin:function(){i.navigateTo({url:"/pages/login/login"})},navToProfile:function(){var t=this.data.userInfo;t.mobile?(n().setFlash("userInfo",t),i.navigateTo({url:"/pages/mine/user/profile/index"})):i.navigateTo({url:"/pages/login/login"})},handleMakeUrl:function(t){var e=t.currentTarget.dataset.url;this.data.userInfo.mobile?i.navigateTo({url:e}):i.navigateTo({url:"/pages/login/login"})},onUnload:function(){S.default.remove(T.default.action.BIND_PHONE_SUCCESS,this)},onHide:function(){this.setData({showModal:!1,url:"/pages/login/login"})},changeuser:function(){var t=i.getStorageSync("userinfo");this.setData({userInfo:t})}}),Page(k)}),window.define("tabs/order/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/o2o-orders/orders"),y=m(w),v=t("../../utils/util"),D=m(v),x=t("../../dist/index"),b=m(x),T={data:{}};D.default.registComp(T,b.default.TopTips,y.default),Page(T)}),window.define("tabs/about/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/about/about"),y=m(w),v=t("../../utils/util"),D=m(v),x={data:{}};D.default.registComp(x,y.default,{onShareAppMessage:function(){return{path:"/tabs/home/index?shareCode="+n().globalData.userinfo.shareCode}}}),Page(x)}),window.define("tabs/map/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/map/map"),y=m(w),v=t("../../utils/util"),D=m(v),x={data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:20}}};D.default.registComp(x,y.default,{onShareAppMessage:function(){return{path:"/tabs/home/index?shareCode="+n().globalData.userinfo.shareCode}}}),Page(x)}),window.define("tabs/brandlist/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../network/api.js"),y=m(w),v=t("../../utils/const.js"),D=m(v),x=t("../../utils/notification"),b=m(x),T=t("../../utils/location.js"),C=m(T);Page({data:{locationSuccess:!0,loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:20}},init:function(){var t=this,e=n().globalConfig;if(e)if(this.setData(Object.assign({},this.data,{globalConfig:e})),e.isEnableLocation){var a=n().globalData.location;a&&a.location?(this.setData({location:a}),this.queryBrandList({pageNo:1,pageSize:20},!0)):(i.showLoading({title:"定位中..."}),C.default.ensureLocation(e).then(function(){i.hideLoading()}).catch(function(e){console.log(e),t.setData({locationSuccess:!1}),i.hideLoading()}))}else i.showLoading({title:"请稍候"}),this.queryBrandList({pageNo:1,pageSize:20},!0)},onLoad:function(){var t=this;b.default.register(D.default.action.QUERY_CONFIG_SUCCESS,this,function(){t.init()}),b.default.register(D.default.action.LOCATION_CHANGED,this,function(e){t.setData({location:e.data,locationSuccess:!0}),i.showLoading({title:"请稍候"}),t.queryBrandList({pageNo:1,pageSize:20},!0)}),this.init()},queryBrandList:function(t,e){var a=this;y.default.getBrandListByLocation(t).then(function(t){console.log(t,"++++"),i.hideLoading(),a.setData({list:e?t.data.data:a.data.list.concat(t.data.data),isShow:!0,loadmore:t.data.nextCursor>0,loadingmore:!1,query:{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}}),console.log(t,"++++++++++++")}).catch(function(t){return console.log(t)})},handlestorelist:function(t){var e=t.currentTarget.dataset.brand;n().setFlash("brand",e),i.navigateTo({url:"/pages/storelist/storelist"})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(console.log(t),this.setData({loadingmore:!0}),this.queryBrandList(this.data.query,!1))},onUnload:function(){b.default.remove(D.default.action.QUERY_CONFIG_SUCCESS,this),b.default.remove(D.default.action.LOCATION_CHANGED,this)}})}),window.define("tabs/custome/custome",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{width:750},onLoad:function(){var t=n().globalConfig;this.setData({globalConfig:t}),i.showLoading({title:"请稍后"}),this.queryCustom()},onShareAppMessage:function(){var t=n().globalData.userinfo;return{imageUrl:this.data.shareImg,path:"/tabs/custome/custome?shareCode="+t.shareCode,title:this.data.desc||this.data.title}},onPullDownRefresh:function(){this.queryCustom(),console.log("++++++++++++++++")},queryCustom:function(){var t=this;w.default.queryCustom().then(function(e){i.stopPullDownRefresh(),i.hideLoading(),t.setData(Object.assign({},e.data,{serverTime:e.serverTime}))}).catch(function(t){console.log(t),i.hideLoading()})}})}),window.define("tabs/carts/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{},onLoad:function(){var t=i.getStorageSync("userinfo");this.setData({userinfo:t}),i.showLoading({title:"请稍后",mask:!0})},queryCarts:function(){var t=this;w.default.queryCarts().then(function(e){i.hideLoading(),t.setData({carts:e.data})})},onShow:function(){this.queryCarts();var t=i.getStorageSync("userinfo");this.setData({userinfo:t})},deleteStore:function(t){var e=t.currentTarget.dataset.storeid,a=this;i.showModal({content:"确定清空购物车的商品吗？",cancelText:"取消",confirmText:"确定",success:function(t){t.confirm&&(i.showLoading({title:"请稍后",mask:!0}),w.default.clearCartStoreAll({storeId:e}).then(function(t){t&&t.data&&t.data.result&&(i.showLoading({title:"请稍后",mask:!0}),a.queryCarts())}).catch(function(t){return console.log(t)}))}}),console.log(e)},changeuser:function(){var t=i.getStorageSync("userinfo");this.setData({userinfo:t})},gotoLogin:function(){i.navigateTo({url:"/pages/login/login"})}})}),window.define("tabs/publish/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{},bindPublish:function(t){var e=t.currentTarget.dataset.url;console.log(t);var a=i.getStorageSync("userinfo");this.setData({userinfo:a}),a.mobile?i.navigateTo({url:e}):this.setData({showModal:!0,url:"/pages/login/login"})}})}),window.define("tabs/supplyBuy/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/supply/supply"),y=m(w),v=t("../../utils/util"),D=m(v),x=t("../../dist/index"),b={data:{}};D.default.registComp(b,y.default,x.TopTips,{onShareAppMessage:function(){return{path:"/tabs/home/index?shareCode="+n().globalData.userinfo.shareCode}}}),Page(b)}),window.define("tabs/info/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{options:{}},onLoad:function(t){this.setData({options:Object.assign({},t,{from:"tabs",dsId:"",dataType:1})})}})}),window.define("tabs/fenxiao/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../utils/util.js"),y=m(w),v=t("../../component/fenxiao/index.js"),D=m(v),x=y.default.registComp({},D.default,{onShow:function(){D.default.onShow.call(this),this.init()},onHide:function(){this.setData({showModal:!1,url:"/pages/login/login"})}});Page(x)}),window.define("tabs/giftCard/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{giftcardlistData:[]},onLoad:function(t){this.queryGiftcardList()},onPullDownRefresh:function(){this.queryGiftcardList()},queryGiftcardList:function(){var t=this;i.showLoading({title:"请稍后"}),w.default.getIndexMenu({sign:"giftCard"}).then(function(e){console.log(e,"++++"),i.hideLoading(),t.setData({giftcardlistData:e.data.options.data})}).catch(function(t){return console.log(t)})},onTapGiftCardBuy:function(t){var e=t.currentTarget.dataset.id;i.navigateTo({url:"/pages/giftcard/buy/index?urlType=tabGigtCard&id="+e})}})}),window.define("tabs/goodsCategory/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{brandList:[],currentIndex:0},onLoad:function(){i.showLoading({title:"请稍后"})},onShow:function(){this.queryList()},handleCheckClassify:function(t){console.log(t,"eee"),i.navigateTo({url:"/pages/sources/products/index?categoryIds="+t.id})},queryList:function(){var t=this;w.default.queryIndexCategoryV2().then(function(e){console.log(e,"res"),i.hideLoading(),t.setData({brandList:e.data})})}})}),window.define("tabs/company/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{selectArea:{},tab:"tab",dataType:1},onLoad:function(){this.selectComponent("#company").handleLoad()},onShow:function(){var t=n().getFlash("address");if(t){console.log(t);var e=t.province,a=t.city,o=t.district;this.setData({selectArea:{provinceCode:e.code,cityCode:a.code||0,districtCode:o.code||0,city:""+(e.fullName||"")+(a.fullName||"")+(o.fullName||""),code:((e.code||0)+","+(a.code||0)+","+(o.code||0)).split(",").filter(function(t){return 0!=t}).join(",")}})}}})}),window.define("tabs/picture/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({onLoad:function(){this.selectComponent("#picture").handleLoad({})}})}),window.define("tabs/designer/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({onLoad:function(t){this.selectComponent("#designer").handleLoad(Object.assign({},t,{from:"dataSource",dsId:"",dataType:1}))}})}),window.define("tabs/live/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({onShow:function(){this.selectComponent("#livePage").renderStartButton()}})}),window.define("modules/map/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/map/map"),y=m(w),v=t("../../utils/util"),D=m(v),x={data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:20}}};D.default.registComp(x,y.default),Page(x)}),window.define("modules/custome/custome",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({onPullDownRefresh:function(){var t=this.data.id;this.queryPageById(t)},onLoad:function(t){this.setData({id:t.id}),i.showLoading({title:"请稍后"}),this.queryPageById(t.id)},onShareAppMessage:function(){return{imageUrl:this.data.shareImg,title:this.data.desc||this.data.title}},queryPageById:function(t){var e=this;w.default.getPageById({id:t}).then(function(t){i.stopPullDownRefresh(),i.hideLoading(),e.setData(Object.assign({},t.data,{serverTime:t.serverTime}))}).catch(function(t){console.error(t),i.hideLoading()})}})}),window.define("pages/webview/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../utils/util.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({onLoad:function(t){console.log(w.default.parse(t.url),"options"),this.setData({url:w.default.parse(t.url)})}})}),window.define("pages/addressdetail/addressdetail",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../network/api"),y=m(w),v=t("../../utils/const.js"),D=m(v),x=t("../../utils/notification"),b=m(x),T=t("../../utils/location.js"),C=m(T),S=t("../../utils/util.js"),L=m(S),_=t("../../dist/index"),k=L.default.registComp({},_.Toast,{onLoad:function(t){var e=t.addressid;this.setData({id:e}),i.showLoading({title:"加载中"})},onShow:function(){this.queryAddressList({pageSize:1e3,pageNo:1,gpsType:"gps"})},editaddress:function(t){console.log(t.currentTarget.dataset,"+++++++++");var e=t.currentTarget.dataset.address;i.navigateTo({url:"/pages/address/new/new?type=edit&isAddress=true&item="+L.default.stringify(e)})},newaddress:function(){i.getStorageSync("userinfo").mobile?i.navigateTo({url:"/pages/address/new/new?type=new&isAddress=true"}):this.setData({showModal:!0,url:"/pages/login/login"})},queryAddressList:function(t){var e=this;y.default.queryAddressList(t).then(function(t){i.stopPullDownRefresh(),i.hideLoading(),console.log("bingooooooooooooo",t),e.setData({list:t.data.data,isShow:!0})}).catch(function(t){return console.log(t)})},getLocation:function(){var t=this;i.showLoading({title:"定位中..."}),C.default.getLocation().then(function(){i.hideLoading(),i.navigateBack()}).catch(function(e){i.hideLoading(),console.log(e),t.showZanToast("定位失败，请重试定位或选择其他收货地址")})},makesetting:function(){var t=this;i.getSetting({success:function(e){e.authSetting["scope.userLocation"]?t.getLocation():i.openSetting({success:function(e){e.authSetting["scope.userLocation"]&&t.getLocation()}})}})},addressLocation:function(t){var e=t.currentTarget.dataset.address;y.default.getUserLocation({latitude:e.lat,longitude:e.lng,type:0}).then(function(t){var a=i.getStorageSync("location"),o=Object.assign({},a,{latitude:e.lat,longitude:e.lng,location:e.title,cityName:e.city,addressId:e.id,cityCode:t.data.cityCode});n().globalData.location=o,i.setStorageSync("location",o),b.default.post(D.default.action.LOCATION_CHANGED,o)}),i.navigateBack()},makesearch:function(){i.redirectTo({url:"/pages/addresssearch/addresssearch"})}});Page(k)}),window.define("pages/addresssearch/addresssearch",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../network/api"),y=m(w),v=t("../../utils/const"),D=m(v),x=t("../../utils/notification"),b=m(x);Page({data:{},onLoad:function(t){var e=this;this.queryCitys();var a=n().globalData.location;console.log(a,"location"),a&&this.setData({cityName:a.cityName}),b.default.register(D.default.action.SEARCH_CITY,this,function(t){console.log("get notiffffffffffffffffffffff",t),e.setData({cityName:t.data})})},changevalue:function(t){console.log(t.detail.value),this.setData({inputValue:t.detail.value})},clearValue:function(){this.setData({inputValue:""})},searchCtiy:function(t){console.log(t.detail.value);var e={cityName:this.data.cityName,keyword:""+t.detail.value};this.queryMap(e)},handleSearch:function(){var t={cityName:this.data.cityName,keyword:this.data.inputValue};this.queryMap(t)},queryMap:function(t){var e=this;i.showLoading({title:"加载中"}),y.default.queryMap(t).then(function(t){i.hideLoading(),i.stopPullDownRefresh(),console.log("bingooooooooooooo",t),e.setData({addresslist:t.data})}).catch(function(t){return console.log(t)})},makeCitys:function(){i.navigateTo({url:"/pages/citys/citys?city="+this.data.cityName+"&from=search"})},queryCitys:function(){var t=this;y.default.getIndexCities().then(function(e){i.stopPullDownRefresh();for(var a=e.data.cityList,o=[],n=0;n<a.length;n++)o=o.concat(a[n].cities);t.data.cityName||t.setData({cityName:o[0]})}).catch(function(t){return console.log(t)})},bindaddress:function(t){console.log("item",t.currentTarget.dataset.item);var e=t.currentTarget.dataset.item,a={latitude:e.location.lat,longitude:e.location.lng,location:e.title,cityName:e.city,addressId:e.id};n().globalData.location=a,i.setStorageSync("location",a),y.default.getUserLocation({latitude:e.location.lat,longitude:e.location.lng,type:0}).then(function(t){b.default.post(D.default.action.LOCATION_CHANGED,a),i.navigateBack()})},onUnload:function(){b.default.remove(D.default.action.SEARCH_CITY,this)}})}),window.define("pages/citys/citys",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../network/api"),y=m(w),v=t("../../utils/const.js"),D=m(v),x=t("../../utils/notification"),b=m(x),T=t("../../utils/location.js"),C=m(T);Page({data:{},onLoad:function(t){t.city&&this.setData({city:t.city}),t.isLocation&&this.setData({isLocation:t.isLocation}),t.from&&this.setData({type:t.from});var e=i.getStorageSync("config");this.setData({config:e}),this.querycitys()},hotCity:function(){this.setData({scrollTop:0})},clickLetter:function(t){console.log(t.currentTarget.dataset.letter);var e=t.currentTarget.dataset.letter;this.setData({showLetter:e,isShowLetter:!0,scrollTopId:e});var a=this;setTimeout(function(){a.setData({isShowLetter:!1})},1e3)},querycitys:function(){var t=this;i.showLoading({title:"加载中"}),y.default.queryIndexCityV2().then(function(e){i.stopPullDownRefresh(),t.setData({isShow:!0,cityList:e.data.cityList,shortNames:e.data.shortNames,hots:e.data.hotCityList},function(){i.hideLoading()}),console.log(e,"+++++++++++")}).catch(function(t){return console.log(t)})},bindCity:function(t){var e=t.currentTarget.dataset.city;if(console.log(e,"+++++++++++++++++++++"),this.setData({searchShow:!1,searchlist:[],city:e.cityName}),i.showLoading({title:"加载中"}),"hotel"==this.data.type)b.default.post(D.default.action.HOTEL_LOCATION_CHANGED,{location:e.cityName,cityName:e.cityName,isLocation:2,cityCode:e.cityCode}),i.navigateBack();else if("search"==this.data.type)b.default.post(D.default.action.SEARCH_CITY,e.cityName),i.navigateBack();else{var a=i.getStorageSync("location"),o=a.latitude,s=void 0===o?"":o,r=a.longitude,d=void 0===r?"":r;y.default.selectIndexCityV2({cityCode:e.cityCode,latitude:""+s,longitude:""+d}).then(function(t){if(i.stopPullDownRefresh(),i.hideLoading(),t.data.result){var a=n().globalData.location,o=Object.assign({},a,{location:e.cityName,cityName:e.cityName,cityCode:e.cityCode});n().globalData.location=o,i.setStorageSync("location",o),b.default.post(D.default.action.HOTEL_LOCATION_CHANGED,{location:e.cityName,cityName:e.cityName,isLocation:2,cityCode:e.cityCode}),b.default.post(D.default.action.LOCATION_CHANGED,o),i.navigateBack()}}).catch(function(t){return console.log(t)})}},searchCtiy:function(t){var e=this;if(console.log(t.detail.value),""!==t.detail.value){var a={keyword:t.detail.value};y.default.queryIndexSearchCity(a).then(function(t){i.stopPullDownRefresh(),i.hideLoading(),e.setData({searchShow:!0,searchlist:t.data}),console.log(t,"+++++++++++")}).catch(function(t){return console.log(t)})}},removesearch:function(t){""==t.detail.value&&this.setData({searchShow:!1,searchlist:[]})},getLocation:function(){var t=this,e=this;i.showLoading({title:"定位中..."}),C.default.getLocationInfo().then(function(e){console.log(e,"res"),"hotel"==t.data.type&&b.default.post(D.default.action.HOTEL_LOCATION_CHANGED,{cityName:e.cityName,location:e.location,isLocation:1,cityCode:e.cityCode}),i.hideLoading(),i.navigateBack()}).catch(function(t){i.hideLoading(),console.log(t),e.showZanToast("定位失败，请重试定位或选择其他城市")})},makesetting:function(){var t=this;i.getSetting({success:function(e){e.authSetting["scope.userLocation"]?t.getLocation():i.openSetting({success:function(e){e.authSetting["scope.userLocation"]&&t.getLocation()}})}})},hideSearch:function(){this.setData({searchShow:!1})}})}),window.define("pages/login/login",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../utils/util"),y=m(w),v=t("../../network/api"),D=m(v),x=t("../../utils/const.js"),b=m(x),T=t("../../utils/notification.js"),C=m(T),S=t("../../dist/index"),L={data:{loading:!1,verify:!1,count:60,countDown:!1,steps:[{current:!0,done:!0,text:"步骤一",desc:"10.01"},{done:!1,current:!1,text:"步骤二",desc:"10.02"}]}};y.default.registComp(L,S.Toast,S.TopTips,{onLoad:function(t){var e=t.type||"",a=t.from||"",o=t.channelCode||"",i=t.zhaomuName||"";this.setData({type:e,from:a,zhaomuName:i,channelCode:o})},getCode:function(){var t=this;if(this.data.verify){var e=this,a={mobile:this.data.phone};this.data.loading||this.data.countDown||(i.showLoading({title:"请稍候"}),this.setData({loading:!0}),D.default.checkBindMobileIsExist(a).then(function(o){i.hideLoading(),i.stopPullDownRefresh(),t.setData({loading:!1}),o.data.exist?t.showZanTopTips("该手机号已经被绑定过"):(t.setData({countDown:!0}),D.default.getVerifyCode(a).then(function(a){i.stopPullDownRefresh(),console.log("bingooooooooooooo",a),a.data.result?e.setCount():t.showZanTopTips("获取验证码失败")}).catch(function(t){return console.log(t)}))}).catch(function(e){console.log(e),i.hideLoading(),t.setData({loading:!1})}))}},verifyPhone:function(t){this.setData({verify:11==t.detail.value.length&&/^1[0-9]{10}$/.test(t.detail.value),phone:t.detail.value})},formSubmit:function(t){var e=this;console.log(t.detail.value);var a=t.detail.value,o=void 0;return a.phone&&0!=a.phone.trim().length?/^1[0-9]{10}$/.test(a.phone)?a.verifyCode&&0!=a.verifyCode.trim().length?void D.default.bindMobile({verifyCode:a.verifyCode,mobile:a.phone}).then(function(t){if(i.stopPullDownRefresh(),console.log("bingooooooooooooo",t),t.data.result){i.showToast({title:"手机号绑定成功",duration:1e3});var o=i.getStorageSync("userinfo");console.log(o),o.mobile=a.phone,i.setStorageSync("userinfo",o),n().globalData.userinfo=o,console.log("this.data.type="+e.data.type),"zhaomu"===e.data.type?e.applyRecruitment():i.navigateBack({delta:1})}else e.showZanTopTips(t.data.msg?t.data.msg:"验证码不正确")}).catch(function(t){return console.log(t)}):(o="验证码不能为空",void this.showZanTopTips(o)):(o="请输入正确手机号",void this.showZanTopTips(o)):(o="手机号不能为空",void this.showZanTopTips(o))},applyRecruitment:function(){var t=this;D.default.applyRecruitment({from:this.data.from,channelCode:this.data.channelCode}).then(function(){var e=i.getStorageSync("userinfo");e.isDist=!0,i.setStorageSync("userinfo",e),n().globalData.userinfo=e,console.log("----userInfo--54545-------",e),t.data.zhaomuName||i.showToast({title:"恭喜您，已成功申请为"+t.data.zhaomuName+"！",duration:1e3}),C.default.post(b.default.action.BIND_PHONE_SUCCESS,{}),setTimeout(function(){i.navigateBack({delta:1})},2e3)}).catch(function(t){console.log("apply err=>",t),i.hideLoading(),i.showToast({title:D.default.errors(t.error)||"网络连接错误，请稍后重试",duration:1e3}),setTimeout(function(){i.navigateBack({delta:1})},2e3)})},setCount:function(){var t=this.data,e=t.count,a=t.phone,o=this;if(0==e&&11==a.length&&/^1[0-9]{10}$/.test(a))return void this.setData({verify:!0,phone:a,count:60,countDown:!1});var i=e-1;this.setData({count:i}),setTimeout(function(){o.setCount()},1e3)}}),Page(L)}),window.define("pages/brandlist/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/brandlist/brandlist"),y=m(w),v=t("../../utils/util"),D=m(v),x={data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:20}}};D.default.registComp(x,y.default),Page(x)}),window.define("pages/aboutmine/aboutmine",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({onLoad:function(t){if(t){var e=JSON.parse(t.aboutmine);this.setData({about:e})}}})}),window.define("pages/page/search/search",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t,e){var a={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(a[o]=t[o]);return a}var w=function(){function t(t,e){var a=[],o=!0,i=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(o=(s=r.next()).done)&&(a.push(s.value),!e||a.length!==e);o=!0);}catch(t){i=!0,n=t}finally{try{!o&&r.return&&r.return()}finally{if(i)throw n}}return a}return function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=t("../../../utils/es6-promise.min.js"),v=function(t){return t&&t.__esModule?t:{default:t}}(y),D=t("../../../network/api");Page({data:{tabs:[{title:"全部",current:!0},{title:"店铺"}],keyword:"",currentTab:0,products:{},stores:{}},onLoad:function(){},onTabSwitch:function(t){var e=t.currentTarget.dataset.index,a=this.data.tabs;console.log(e,a),a.forEach(function(t,a){t.current=e==a}),this.setData({tabs:a,currentTab:e})},onSearch:function(t){var e=this;console.log(t,"eeee"),i.showLoading({mask:!0,title:"请稍后"}),this.setData({keyword:t.value});var a={keyword:t.value,sort:"sales:descend"};v.default.all([(0,D.queryGoodsProperties)(a),(0,D.queryIndexGoods)(a),(0,D.queryIndexStores)(a)]).then(function(t){i.hideLoading();var a=w(t,3),o=a[0],n=a[1],s=a[2];console.log(t),e.setData({serverTime:n.serverTime,filters:o.data,products:n.data,stores:s.data})}).catch(function(t){i.hideLoading(),console.log(t)})},handleQueryProducts:function(t){var e=this;i.showLoading({mask:!0,title:"请稍后"});var a=t.sort,o=t.query,n=this.data.keyword,s=Object.assign({keyword:n,sort:a},o),r=this.data.products;(0,D.queryIndexGoods)(s).then(function(t){i.hideLoading();var a=t.data,o=m(t,["data"]);console.log(o,"+++++++++++++++,--------------"),a.pageNo>1?e.setData({products:Object.assign({},a,{data:r.data.concat(a.data)})}):e.setData({products:a,filters:a.data.length>0?e.data.filters:{}})}).catch(function(t){i.hideLoading(),console.log(t)})},handleQueryStores:function(t){var e=this;i.showLoading({mask:!0,title:"请稍后"});var a=t.sort,o=this.data.keyword,n={keyword:o,sort:a},s=this.data.stores;(0,D.queryIndexStores)(n).then(function(t){i.hideLoading();var a=t.data;a.pageNo>1?e.setData({stores:Object.assign({},a,{data:s.data.concat(a)})}):e.setData({stores:a})}).catch(function(t){i.hideLoading(),console.log(t)})},makeproject:function(t){var e=t.currentTarget.dataset.project;i.redirectTo({url:"/pages/services/service_detail/index?shopId="+e.storeId+"&serviceId="+e.id})}})}),window.define("pages/storelist/storelist",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{storelist:[],query:{pageSize:20,pageNo:1},storetype:""},onLoad:function(){var t=n().globalData.editionType,e=n().getFlash("brand");console.log(e);var a=e.id;this.setData({brand:e,storetype:t,query:Object.assign({},this.data.query,{brandId:a})}),i.showLoading({title:"加载中"}),this.queryStoreList(this.data.query)},makestore:function(t){console.log(t.currentTarget.dataset.store,")((((((((((((((()))))))))))))))"),i.redirectTo({url:"/pages/shop/products/products?storeid="+t.currentTarget.dataset.store.id})},queryStoreList:function(t,e){var a=this;w.default.getStoreListByLocation(t).then(function(t){i.hideLoading(),a.setData({storelist:e?t.data.data:a.data.storelist.concat(t.data.data),isShow:!0,loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize})}),console.log(t,"++++++++++++")}).catch(function(t){return console.log(t)})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(console.log(t),this.setData({loadingmore:!0}),this.queryStoreList(this.data.query,!1))},makePhone:function(t){var e=this;console.log(t.target.dataset),t.target.dataset.phone?i.makePhoneCall({phoneNumber:t.target.dataset.phone}):(this.setData({$toast:{show:!0}}),setTimeout(function(){e.setData({$toast:{show:!1}})},1500))}})}),window.define("pages/address/list/list",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../network/api"),y=m(w),v=t("../../../utils/util"),D=m(v),x=t("../../../dist/index"),b=m(x);Page(Object.assign({},b.default.Toast,{data:{list:[]},onLoad:function(t){if(i.showLoading({title:"请稍后"}),t.scoreorder){var e=D.default.parse(t.scoreorder);"order"==t.type&&this.setData({type:t.type}),this.setData({scoreorder:e,formData:D.default.parse(t.formData)})}},onReady:function(){},onShow:function(){this.data.scoreorder,this.queryAddressList({pageSize:999,pageNo:1})},makenew:function(){if(this.data.scoreorder){var t=this.data.scoreorder;"order"==this.data.type?i.redirectTo({url:"/pages/address/new/new?type=new&scoreorder="+D.default.stringify(t)+"&formData="+D.default.stringify(this.data.formData)+"&ordertype=order"}):i.redirectTo({url:"/pages/address/new/new?type=new&scoreorder="+D.default.stringify(t)+"&formData="+D.default.stringify(this.data.formData)})}else i.navigateTo({url:"/pages/address/new/new?type=new"})},makeorder:function(t){if(this.data.scoreorder){var e=t.currentTarget.dataset.address;console.log(e,"++++++++++++++");var a=this.data.scoreorder;a.consignee=e,this.data.type?(console.log(a,"scoreorder"),i.redirectTo({url:"/pages/orders/new/new?from=address&order="+D.default.stringify(a)+"&formData="+D.default.stringify(this.data.formData)})):i.redirectTo({url:"/pages/mine/scores/score_new_order?from=address&scoreorder="+D.default.stringify(a)+"&formData="+D.default.stringify(this.data.formData)})}},queryAddressList:function(){var t=this;y.default.queryAddressList({pageSize:999,pageNo:1,gpsType:"all"}).then(function(e){i.stopPullDownRefresh(),i.hideLoading(),console.log("bingooooooooooooo",e),t.setData({list:e.data.data,isShow:!0})}).catch(function(t){return console.log(t)})},editaddress:function(t){var e=t.currentTarget.dataset.item;if(this.data.scoreorder){var a=this.data.scoreorder;"order"==this.data.type?i.redirectTo({url:"/pages/address/new/new?type=edit&scoreorder="+D.default.stringify(a)+"&item="+D.default.stringify(e)+"&formData="+D.default.stringify(this.data.formData)+"&ordertype=order"}):i.redirectTo({url:"/pages/address/new/new?type=edit&scoreorder="+D.default.stringify(a)+"&item="+D.default.stringify(e)+"&formData="+D.default.stringify(this.data.formData)})}else i.navigateTo({url:"/pages/address/new/new?type=edit&item="+D.default.stringify(e)})},deleteaddress:function(t){var e=this;i.showModal({title:"确定要删除该地址吗",success:function(a){if(a.confirm){console.log(t.currentTarget.dataset,"e");var o=t.currentTarget.dataset.item.id;y.default.deleteAddress({id:o}).then(function(){if(e.showToast("地址删除成功"),i.showLoading({title:"请稍后"}),e.data.order){var t=e.data.goodsId;e.queryorderList({goodsId:t,pageSize:999,pageNo:1})}else e.data.scoreorder,e.queryAddressList({pageSize:999,pageNo:1})}).catch(function(){e.showToast("地址删除失败")})}}})},showToast:function(t){this.showZanToast(t)}}))}),window.define("pages/address/search/search",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../network/api"),y=m(w),v=t("../../../utils/util"),D=m(v);Page({data:{},onLoad:function(t){t.isWxAddress&&this.setData({isWxAddress:!0}),t.order?this.setData({order:D.default.parse(t.order),item:D.default.parse(t.item),formData:D.default.parse(t.formData)}):t.scoreorder&&(t.ordertype&&this.setData({ordertype:t.ordertype}),this.setData({scoreorder:D.default.parse(t.scoreorder),item:D.default.parse(t.item),formData:D.default.parse(t.formData)})),this.setData({cityName:t.city,provinceName:t.province,type:t.type})},handleChangeValue:function(t){this.setData({keyword:""+t.detail.value})},searchCtiy:function(){var t=this;if(this.data.keyword){var e={cityName:this.data.provinceName+this.data.cityName,keyword:this.data.keyword};y.default.queryMap(e).then(function(e){i.stopPullDownRefresh(),console.log("bingooooooooooooo",e),t.setData({addlist:e.data})}).catch(function(t){return console.log(t)})}},bindaddress:function(t){var e=t.currentTarget.dataset.item;if(this.data.order)if("edit"==this.data.type){console.log("+++++++++++++++++");var a=this.data.isWxAddress,o=void 0===a?"":a;this.handleJump("/pages/address/new/new?order="+D.default.stringify(this.data.order)+"&search="+D.default.stringify(e)+"&item="+D.default.stringify(this.data.item)+"&formData="+D.default.stringify(this.data.formData)+"&type="+this.data.type+"&isWxAddress="+o)}else this.handleJump("/pages/address/new/new?order="+D.default.stringify(this.data.order)+"&search="+D.default.stringify(e)+"&item="+D.default.stringify(this.data.item)+"&type="+this.data.type+"&formData="+D.default.stringify(this.data.formData));else if(this.data.scoreorder)if("edit"==this.data.type){var s="/pages/address/new/new?scoreorder="+D.default.stringify(this.data.scoreorder)+"&search="+D.default.stringify(e)+"&item="+D.default.stringify(this.data.item)+"&formData="+D.default.stringify(this.data.formData);this.data.ordertype?this.handleJump(s+"&ordertype=order"):this.handleJump(s)}else{var r="/pages/address/new/new?scoreorder="+D.default.stringify(this.data.scoreorder)+"&search="+D.default.stringify(e)+"&item="+D.default.stringify(this.data.item)+"&type="+this.data.type+"&formData="+D.default.stringify(this.data.formData);this.data.ordertype?this.handleJump(r+"&ordertype=order"):this.handleJump(r)}else console.log(e,"searchAddress"),n().setFlash("searchAddress",e),i.navigateBack()},handleJump:function(t){i.redirectTo({url:t})}})}),window.define("pages/address/new/new",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../dist/index"),y=m(w),v=t("../../../utils/util"),D=m(v),x=t("../../../network/api"),b=m(x),T={data:{isShow:!1,index:0,item:{},isbtn:!0,storetype:""}};D.default.registComp(T,y.default.Toast,{onLoad:function(t){var e=n().globalData.editionType;if(this.setData({storetype:e}),"edit"==t.type){var a=D.default.parse(t.item);this.setData({item:a})}if(t.search){var o=D.default.parse(t.search),i=D.default.parse(t.item);this.setData({item:Object.assign({},i,{lng:o.location.lng,lat:o.location.lat,title:o.title})})}t.isWxAddress&&this.setData({isWxAddress:!0}),t.isAddress&&this.setData({isAddress:!0}),t.scoreorder&&(t.ordertype&&this.setData({ordertype:t.ordertype}),this.setData({scoreorder:D.default.parse(t.scoreorder),formData:D.default.parse(t.formData)})),this.setData({type:t.type})},onReady:function(){},onShow:function(){var t=n().getFlash("address"),e=n().getFlash("searchAddress");console.log(e),t&&(this.data.item.city!==t.city.fullName&&this.setData({"item.title":"","item.lng":"","item.lat":""}),this.setData({"item.province":t.province.fullName,"item.cityCode":t.city.code,"item.city":t.city.fullName,"item.district":t.district.fullName||""})),e&&(console.log(e),this.setData({"item.lng":e.location.lng,"item.lat":e.location.lat,"item.title":e.title}))},formSubmit:function(){var t=void 0,e=this.data.item,a=e.province,o=e.city,i=e.district,n=e.title,s=e.address,r=e.name,d=e.phone,u=e.cityCode,c=e.lng,l=e.lat,h=e.adcode;if(o&&a?s&&0!=s.trim().length?r&&0!=r.trim().length?d&&0!=d.trim().length?/^1[0-9]{10}$/.test(d.trim())||(t="手机号码格式错误"):t="请输入手机号码":t="请输入姓名":t="请输入详细地址":t="请选择收货地区",t)this.showToast(t);else{var g={name:r,phone:d,address:s,province:a,city:o,district:i,adcode:u||h};if(n&&(g=Object.assign({},g,{title:n,lng:c,lat:l})),"new"==this.data.type)this.createAddress(g,!1);else{var f=this.data.item;g.id=f.id||"",this.editAddress(g,!1)}}},checkAddress:function(t,e,a){var o=this;b.default.isOutRange(t).then(function(t){if(console.log(t,"+++++++++++"),1==t.data.isOutRange){var n=o;i.showModal({content:"您的地址已超出商家配送范围",cancelText:"调整地址",confirmText:"仍然保存",success:function(t){t.confirm&&("edit"==a?n.data.isWxAddress?n.createWxAddress(e,!0):n.editAddress(e,!0):n.createAddress(e,!0))}})}else delete e.storeId,"edit"==a?o.data.isWxAddress?o.createWxAddress(e,!1):o.editAddress(e,!1):o.createAddress(e,!1)}).catch(function(t){return console.log(t)})},showToast:function(t){this.showZanToast(t)},onCommentChange:function(t){var e=this.data.item;e[t.target.id]=t.detail.value,this.setData({item:e})},createAddress:function(t){var e=this;console.log(this.data,"this.data.isbtn"),this.data.isbtn&&(this.setData({isbtn:!1}),i.showLoading({title:"请稍后"}),b.default.createAddress(t).then(function(t){if(console.log("bingooooooooooooo",t),e.setData({isbtn:!0}),e.data.scoreorder){var a=e.data.scoreorder;a.consignee=t.data,e.data.ordertype?(console.log(a,"scoreorder"),e.handleJump("/pages/orders/new/new?from=address&order="+D.default.stringify(a)+"&formData="+D.default.stringify(e.data.formData))):e.handleJump("/pages/mine/scores/score_new_order?from=address&scoreorder="+D.default.stringify(a)+"&formData="+D.default.stringify(e.data.formData))}else i.navigateBack({delta:1})}).catch(function(t){console.log(t),e.setData({isbtn:!0})}))},editAddress:function(t){var e=this;this.data.isbtn&&(this.setData({isbtn:!1}),i.showLoading({title:"请稍后"}),b.default.updataAddress(t).then(function(t){if(i.stopPullDownRefresh(),i.hideLoading({title:"请稍后"}),e.setData({isbtn:!0}),e.data.scoreorder){var a=e.data.scoreorder;a.consignee=t.data,e.data.ordertype?(console.log(a,"scoreorder"),e.handleJump("/pages/orders/new/new?from=address&order="+D.default.stringify(a)+"&formData="+D.default.stringify(e.data.formData))):e.handleJump("/pages/mine/scores/score_new_order?from=address&scoreorder="+D.default.stringify(a)+"&formData="+D.default.stringify(e.data.formData))}else i.navigateBack({delta:1})}).catch(function(t){console.log(t),e.setData({isbtn:!0})}))},handleJump:function(t){i.redirectTo({url:t})}}),Page(T)}),window.define("pages/brandmap/brandmap",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{height:100,isShow:!1,showDialog:!1},onLoad:function(t){var e=this;console.log(t);var a={brandId:t.id,flag:1,pageNo:1,pageSize:999};i.showLoading({title:"加载中"}),w.default.getStoreListByLocation(a).then(function(t){console.log(t.data.data,"++++"),i.hideLoading();var a=t.data.data.filter(function(t){return t.lat&&t.lng}).map(function(t){return{iconPath:"/images/tab/marker.png",width:30,height:45,id:t.id,areaNum:t.areaNum,latitude:t.lat,longitude:t.lng,title:t.storeName,openTimeJson:t.openTimeJson,tel:t.tel,detailAddress:""+t.detailAddress,brandName:t.brandName}});e.setData({markers:a,firstMaker:a[0],includePoints:a,isShow:!0})}).catch(function(t){return console.log(t)})},onReady:function(){this.setData({markers:this.data.markers,includePoints:this.data.includePoints,firstMaker:this.data.firstMaker})},markertap:function(t){var e=this;console.log("markertap",t),this.data.markers.map(function(a){a.id==t.markerId&&e.setData({store:a})});var a=83-4*this.data.store.openTimeJson.length;this.setData({showDialog:!0,height:a})},createmap:function(){var t=this.data.store;i.openLocation({name:t.title,address:t.detailAddress,latitude:parseFloat(t.latitude),longitude:parseFloat(t.longitude),success:function(t){console.log(t)}})},makephone:function(){var t=this.data.store,e=t.tel,a=t.areaNum,o=void 0===a?"":a;i.makePhoneCall({phoneNumber:""+o+e})}})}),window.define("pages/products/show/show",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var y=t("../../../network/api"),v=m(y),D=t("../../../component/open_tuan/index.js"),x=m(D),b=t("../../../utils/const.js"),T=m(b),C=t("../../../utils/notification"),S=m(C),L=t("../../../utils/util.js"),_=m(L),k=t("../../../utils/wxParse/wxParse.js"),q=t("../../../dist/index");Page(Object.assign({},q.Quantity,q.Tab,q.TopTips,q.Toast,x.default,{data:{loading:!0,showDialog:!1,showDialog1:!1,showShareDialog:!1,action:0,cartCount:0,formData:{num:{quantity:1,min:1,max:9999,hasSelect:!1},sku:{price:0,quantity:0},selectSku:{},selectSkuText:""},tabs:{list:[{id:"2",title:"商品详情"}],selectedId:"1",scroll:!1,height:42},tabs2:{list:[{id:"3",title:"购物须知"}],selectedId:"1",scroll:!1,height:42},goods:{id:0,name:"",price:0,props:[],content:"",images:[],coverImg:"",specs:[],skus:[]},relativeModule:{pttext:{listType:"type2",cartType:"type1",goods:[]}},toggle:!0,isFirstLoading:!0,isOnTapPic:!1,limit:!1},onLoad:function(t){var e=this;this.setData({id:t.id,shareCode:t.shareCode||"",isFromShop:t.isFromShop,from:t.from?"normal"==t.from?"":t.from:"",height:750,isService:t.isService||!1});var a=i.getStorageSync("config");console.log("+++++++++config",a),this.setData({config:a}),S.default.register(T.default.action.QUERY_CONFIG_SUCCESS,this,function(t){e.setData({config:t.data})})},onShow:function(){this.data.isOnTapPic||(this.data.isFirstLoading?(this.queryProductById(!0),this.setData({isFirstLoading:!1})):this.queryProductById(!1))},onUnload:function(){clearInterval(this.seckKilltimer),this.seckKilltimer=void 0,clearInterval(this.timerMore),this.timerMore=void 0,clearInterval(this.openTuanTimer),this.openTuanTimer=void 0,S.default.remove(T.default.action.QUERY_CONFIG_SUCCESS,this)},onShareAppMessage:function(){var t=n().globalData.userinfo,e=this,a="/pages/products/show/show?id="+this.data.id+"&shareCode="+t.shareCode;"distribution"==this.data.from&&1==this.data.goods.isDist&&(a+="&from=share"),console.log("===path=====onShareAppMessage",a,this.data.goods.storeId);var o=this.data.goods.name;return 2==this.data.goods.activityType&&(o="【"+this.data.goods.groupEvent.limitPeople+"人团】"+this.data.goods.groupPrice+"元拼 "+o+"，快来拼团吧!"),{title:o,path:a,success:function(){1!=e.data.goods.isShare?e.collection():v.default.onShareStore({storeId:e.data.goods.storeId})}}},startSecKillCount:function(){var t=this,e=this;this.seckKilltimer=setInterval(function(){if(0==e.data.goods.overTime)return clearInterval(t.timer),void t.queryProductById(!1);var a=e.data.goods.overTime-1;if(a<1)return clearInterval(t.timer),void(t.timer=void 0);e.setData({"goods.overTime":a,"goods.leftTime":_.default.renderTimer(a)})},1e3)},call:function(){var t=this,e=this.data.store,a=e.areaNum,o=e.tel,i=e.extNum,n=[],s=a?a+"-"+o:o;if(console.log("--tel--",o),o){i?n.push(s+"转"+i):n.push(s),console.log("--phone--",n),this.setData({phoneList:n});var r=this.selectComponent(".phoneaction");console.log("phoneaction",r),r&&r.show()}else this.setData({$toast:{show:!0}}),setTimeout(function(){t.setData({$toast:{show:!1}})},1500)},queryProductById:function(t){var e=this,a={};a.id=this.data.id,a.from=this.data.from,"distribution"==this.data.from&&(a.from="share"),a.shareCode=this.data.shareCode,t&&i.showLoading({title:"请稍候"}),console.log("获取商品详情params====>",a),v.default.getStoreGoodDetail(a).then(function(a){i.stopPullDownRefresh(),i.hideLoading();var o=a.data.imgUrl.map(function(t){return{imgUrl:t,link:t,title:t}}),n=[],s="";if(a.data.item&&a.data.item.length>0){console.log("res.data.item.length>0");for(var r=0;r<a.data.item.length;r++)if(a.data.item[r]&&a.data.item[r].values&&a.data.item[r].values.length>0){for(var d=[],u=0;u<a.data.item[r].values.length;u++)d[u]={id:a.data.item[r].values[u].itemValueId,name:a.data.item[r].values[u].itemValue};console.log("-specsList--------------\x3e",d),n[r]={id:a.data.item[r].itemId,name:a.data.item[r].name,specsList:d},0!=r?s+=","+a.data.item[r].name:s=a.data.item[r].name}}else s="数量";console.log("-tempSpecs--------------\x3e",n);var c=[];if(a.data.storeItem&&a.data.storeItem.length>0)for(var l=0;l<a.data.storeItem.length;l++){var h=a.data.storeItem[l].price,g=a.data.storeItem[l].groupPrice||0;4==a.data.activityType&&(h=a.data.storeItem[l].sharePrice),c[l]={id:a.data.storeItem[l].id,properties:a.data.storeItem[l].properties,quantity:a.data.storeItem[l].stock,price:h,groupPrice:g,minBuy:a.data.storeItem[l].minBuy,maxBuy:a.data.storeItem[l].maxBuy}}console.log("this.dealPrice(res.data.originalPrice)==>",e.dealPrice(a.data.originalPrice)),e.setData({goods:Object.assign({},a.data,{formatPrice:e.dealPrice(a.data.price),formatoriginalPrice:e.dealPrice(a.data.originalPrice),formatgroupPrice:e.dealPrice(a.data.groupPrice),formatsharePrice:e.dealPrice(a.data.sharePrice),gstock:a.data.stock,images:o,imgs:a.data.imgUrl,content:a.data.description,coverImg:a.data.imgUrl?a.data.imgUrl[0]:"",specs:n,skus:c,shareCode:a.data.shareCode||"",isShare:a.data.isShare,seckillStatus:a.data.seckillStatus,overTime:a.data.overTime||0,leftTime:1==a.data.activityType?_.default.renderTimer(a.data.overTime):{}}),store:a.data.store,loading:!1,skustexts:s,formData:{num:{quantity:0==a.data.stock?0:a.data.minBuy>0?a.data.minBuy:1,min:0==a.data.stock?0:1,max:a.data.stock,minBuy:0==a.data.stock?0:a.data.minBuy>0?a.data.minBuy:1,maxBuy:a.data.maxBuy>0&&a.data.maxBuy<a.data.stock?a.data.maxBuy:a.data.stock,hasSelect:!1},sku:{id:0,price:4==a.data.activityType?a.data.sharePrice:a.data.price,quantity:a.data.stock,groupPrice:a.data.groupPrice},selectSku:{},selectSkuText:""}}),t&&(k.wxParse("content","html",a.data.description?a.data.description:"暂无",e,5),k.wxParse("shopNotice","html",a.data.shopNotice?a.data.shopNotice:"暂无",e,5)),1==a.data.activityType&&a.data.overTime&&a.data.overTime>0?e.startSecKillCount():2==a.data.activityType&&a.data.groupEvent&&a.data.groupEvent.sponsoringList&&a.data.groupEvent.sponsoringList.length>0&&e.startOpenTuanCount()}).catch(function(t){console.log(t,";;;;;;;;;;;;;;;;;;;;;;;;;"),i.stopPullDownRefresh(),i.hideLoading()})},gotoshop:function(){console.log(this.data.isFromShop,"this.data.isFromShop"),0==this.data.config.bottomMenu?i.switchTab({url:"/tabs/home/index"}):this.data.isFromShop?i.navigateBack({delta:1}):i.redirectTo({url:"/pages/shop/products/products?storeid="+this.data.store.id})},onTapCarousel:function(t){i.previewImage({current:t.currentTarget.dataset.link,urls:this.data.goods.imgs})},toogleSpecDialog:function(){var t=this.data.showDialog?0:1,e=Object.assign({},this.data.formData);e.num.hasSelect=!0,this.setData({showDialog:!this.data.showDialog,action:t,formData:e,limit:!1})},hideDialog:function(){this.setData({showDialog:!1,action:0})},hideDialog1:function(){this.setData({showDialog1:!1})},handleZanQuantityChange:function(t){var e=parseInt(t.quantity),a=isNaN(e)?1:e;a==this.data.formData.num.max&&this.showZanTopTips("已达最大库存数量"),2==this.data.goods.activityType&&6==this.data.action?2==this.data.goods.groupEvent.isBuyLimited&&(a==this.data.goods.groupEvent.limitedCount?this.setData({limit:!0}):this.setData({limit:!1})):(0==this.data.goods.activityType&&3==this.data.action||2==this.data.goods.activityType&&3==this.data.action)&&this.data.formData.sku.maxBuy>0&&(a==this.data.formData.sku.maxBuy?this.setData({limit:!0}):this.setData({limit:!1})),this.setData(w({},"formData.num.quantity",a))},handleBuyNow:function(){this.normalBuyNow()},resetSku:function(){var t=this.data.goods.storeItem;console.log("storeItem====>",t);var e=[],a=this.data.goods;a=Object.assign({},a,{skus:e}),this.setData({goods:a})},normalBuyNow:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,o=n().globalData.userinfo;if(console.log(this.data.action,"KKKKKKKKKKKKKKK",o.accessToken),!o||!o.mobile)return i.navigateTo({url:"/pages/login/login"}),void this.hideDialog();var s=this.data.formData.selectSku,r=this.data.formData.num.hasSelect,d=this.data.formData.num.quantity,u=this.data.goods.specs.length==Object.getOwnPropertyNames(s).length;if(2==this.data.goods.activityType&&6==a?2==this.data.goods.groupEvent.isBuyLimited&&(d==this.data.goods.groupEvent.limitedCount?this.setData({limit:!0}):this.setData({limit:!1})):2==this.data.goods.activityType&&3==a&&this.setData({limit:!1}),(0==this.data.goods.activityType&&3==a||2==this.data.goods.activityType&&3==this.data.action)&&(this.setData({limit:!1}),this.data.formData.sku.maxBuy>0&&(d==this.data.formData.sku.maxBuy?this.setData({limit:!0}):this.setData({limit:!1}))),console.log(this.data.formData.num.quantity,"666",this.data.limit,"777",this.data.action),0==this.data.goods.gstock)this.showZanTopTips("库存为零");else if(r&&u)i.showLoading({title:"请稍候"}),this.setData({showDialog:!1,action:0}),v.default.checkoutSingleOrder(Object.assign({goodsId:this.data.goods.id,propertiesId:this.data.formData.sku.id,num:d,consigneeId:-1},e)).then(function(a){i.hideLoading(),t.setData({showDialog:!1,action:0});var o=a.data;o.shareCode=e.shareCode||"",console.log("checkoutSingleOrder====>",o),1==o.buyLimit?i.showModal({title:"提示",content:"活动期间每人限购"+t.data.goods.limitedCount+"件，\n超出"+t.data.goods.limitedCount+"件恢复原价",success:function(){i.navigateTo({url:"/pages/orders/new/new?order="+_.default.stringify(o)})}}):i.navigateTo({url:"/pages/orders/new/new?order="+_.default.stringify(o)})}).catch(function(e){console.log("err----\x3e",e);var a="";e.data&&e.data.data&&e.data.data.length>0?(e.data.data.forEach(function(t){var e=t.properties.split(";"),o="";e.forEach(function(t){t&&t.length>0&&(o+=t.split(":")[1]||"")});var i=t.maxBuy?"最多购买"+t.maxBuy+"件":""+t.maxBuy?"最少购买"+t.minBuy+"件":"";a+=t.goodsName+":"+o+i+"  "}),a+="超出购买范围"):a=e.data&&e.data.msg?e.data.msg:v.default.errors(e.error)||e.errorMessage||"订单创建失败",t.showZanTopTips(a),i.hideLoading(),t.setData({showDialog:!1,action:0})});else if(!this.data.showDialog){var c=Object.assign({},this.data.formData);c.num.hasSelect=!0,this.setData({showDialog:!0,action:a,formData:c})}},handleAddCart:function(){var t=this,e=this.data.formData.selectSku,a=this.data.formData.num.hasSelect,o=this.data.formData.num.quantity,n=this.data.goods.specs.length==Object.getOwnPropertyNames(e).length;if(console.log("----handleAddCart--------",n,a),0==this.data.goods.gstock)this.showZanTopTips("库存为零");else if(a&&n){i.showLoading({title:"请稍候"}),this.setData({showDialog:!1,action:0});var s=this;v.default.addToCart({goodsId:this.data.goods.id,propertiesId:this.data.formData.sku.id,quantity:o}).then(function(){i.hideLoading(),s.showZanTopTips(t.data.goods.name+"加入购物车成功"),t.setData({showDialog:!1,action:0})}).catch(function(e){console.log("err===============",e);var a=e.data&&e.data.msg?e.data.msg:"加入购物车失败";t.showZanTopTips(a),i.hideLoading(),t.setData({showDialog:!1,action:0})})}else if(console.log("--------"),!this.data.showDialog){var r=Object.assign({},this.data.formData);r.num.hasSelect=!0,this.setData({showDialog:!0,action:2,formData:r})}},handleFenXiaoBuyNow:function(){var t="";this.data.goods.isDist&&1==this.data.goods.isDist&&this.data.from&&"distribution"==this.data.from?t=this.data.goods.shareCode:this.data.goods.isDist&&1==this.data.goods.isDist&&this.data.from&&"share"==this.data.from&&(t=this.data.shareCode),this.normalBuyNow({shareCode:t},4)},handleOpenTuan:function(){this.normalBuyNow({groupId:this.data.goods.groupEvent&&this.data.goods.groupEvent.groupId||"0"},6)},handleMiaoShaBuyNow:function(){this.normalBuyNow({},6)},handleMakeSure:function(){console.log("+++++");var t=this.data.action,e=this.data.formData.selectSku,a=this.data.goods.specs.length==Object.getOwnPropertyNames(e).length;if([2,3,4,5,6].indexOf(t)>-1&&!a)return void this.showZanToast("请选择规格");switch(t){case 2:this.handleAddCart();break;case 3:this.handleBuyNow();break;case 4:this.handleFenXiaoBuyNow();break;case 5:this.handleBuyNow();break;case 6:this.handleOpenTuan()}},handleSpecClick:function(t){var e=this,a=this.data.formData.num.quantity,o=t.currentTarget.dataset,i=t.currentTarget.dataset,n=i.index,s=i.currentindex;if(!o.disabled){var r=Object.assign({},this.data.formData.selectSku);r[o.pid]={id:o.id,name:o.name};var d="";this.data.goods.specs.forEach(function(t){d+=r[t.id]?r[t.id].name:"",d+=r[t.id]?",":""});var u=Object.assign({},this.data.goods);u.specs=u.specs.map(function(t){return r[t.id]&&(t.specsList=t.specsList.map(function(a){return r[t.id].id==a.id?(a.selected=!0,0==n&&(console.log(a,"999999999999999999999999"),u.showCoverImg=e.data.goods.item[0].values[s].skuLogo,u.selectSkuText=e.data.goods.item[0].values[s].itemValue),console.log(u.selectSkuText,"llllllllllllllllllllllllll")):a.selected=!1,a})),t});var c=Object.getOwnPropertyNames(r),l=void 0;u.skus.forEach(function(t){t.properties.filter(function(t){return c.filter(function(e){return t[e]==r[e].id}).length>0}).length==t.properties.length&&(l=t)}),console.log(l),u.specs.length-c.length==1?u.specs.map(function(t){return r[t.id]||(t.specsList=t.specsList.map(function(e){var a=Object.assign({},r);a[t.id]={id:e.id,name:e.name};var o=Object.getOwnPropertyNames(a),i=void 0;return u.skus.forEach(function(t){var n=t.properties.filter(function(t){return o.filter(function(e){return t[e]==a[e].id}).length>0}).length==t.properties.length;console.log("result====>",n),n&&(i=t,e.disabled=i&&0==i.quantity)}),e})),t}):u.specs.length-c.length==0&&u.specs.map(function(t){return t.specsList=t.specsList.map(function(e){var a=Object.assign({},r);a[t.id]={id:e.id,name:e.name};var o=Object.getOwnPropertyNames(a),i=void 0;return u.skus.forEach(function(t){t.properties.filter(function(t){return o.filter(function(e){return t[e]==a[e].id}).length>0}).length==t.properties.length&&(i=t,e.disabled=i&&0==i.quantity)}),e}),t}),this.setData({goods:u,formData:{num:{quantity:l&&this.data.formData.num.quantity>l.quantity?l.quantity:this.data.formData.num.quantity>0?this.data.formData.num.quantity:1,min:this.data.formData.num.min,max:l?l.quantity:this.data.formData.num.max,minBuy:l&&l.minBuy>0?l.minBuy:1,maxBuy:l&&l.maxBuy>0&&l.maxBuy<l.quantity?l.maxBuy:l?l.quantity:99999,hasSelect:this.data.formData.num.hasSelect},sku:l?{price:l.price,groupPrice:l.groupPrice,quantity:l.quantity,id:l.id,maxBuy:l.maxBuy,minBuy:l.minBuy}:this.data.formData.sku,selectSku:r,selectSkuText:d}}),console.log("selectSku----------\x3e",r),this.data.formData.sku.maxBuy>0&&(a==this.data.formData.sku.maxBuy?this.setData({limit:!0}):this.setData(w({limit:!1},"formData.num.quantity",1)))}},collection:function(){var t=this,e=this.data.goods.id;v.default.shareGoodsList({goodsId:e,type:1==this.data.goods.isShare?"cancel":"share"}).then(function(e){if(e&&e.data.result){var a=t.data.goods,o=1==a.isShare?0:1;t.setData({goods:Object.assign({},a,{isShare:o})})}}).catch(function(t){return console.log(t)})},collectionGoods:function(){var t=this,e=this.data.goods,a=e.id;e.hasCollection?v.default.unfollowGoods({goodsId:a}).then(function(){t.setData(w({},"goods.hasCollection",0))}):v.default.followGoods({goodsId:a}).then(function(){t.setData(w({},"goods.hasCollection",1))})},wxParseTagATap:function(t){var e=t.currentTarget.dataset.src;i.redirectTo({url:"/pages/webview/index?url="+_.default.stringify(e)})},showSharePopup:function(){console.log("showSharePopup++++++++++++",this.data.showShareDialog),this.setData({showShareDialog:!0})},hideSharePopup:function(){console.log("showSharePopup++++++++++++",this.data.showShareDialog),this.setData({showShareDialog:!1})},saveImg:function(){var t=this,e=this.data.id,a={goodsId:e};a.from=this.data.from,"distribution"==this.data.from&&(a.from="share"),i.showLoading({title:"请稍候"}),v.default.queryPhotoShare(a).then(function(e){console.log(e,"res"),i.hideLoading(),t.hideSharePopup();var a=e.data.shareUrl;a?t.getWxsetting(a):t.showZanTopTips("生成海报图失败")}).catch(function(){i.hideLoading(),t.hideSharePopup(),t.showZanTopTips("生成海报图失败")})},getWxsetting:function(t){i.previewImage({current:t,urls:[t]})},onTapPic:function(){this.setData({showDialog1:!this.data.showDialog1})},goGoodDetail:function(t){console.log("e---》",t);var e=t.currentTarget.dataset.id;i.navigateTo({url:"/pages/products/show/show?id="+e+"&isFromShop=true"})},dealPrice:function(t){if(t<1e5)return t;if(t<1e8){var e=t/1e4+"",a=e.indexOf(".");return-1==a?e+".00万":(console.log("====",(e+"").length,a),(e+"").length>a+2?e.substring(0,a+3)+"万":e.substring(0,a+2)+"0万")}var e=t/1e8+"",a=e.indexOf(".");return-1==a?e+".00亿":(e+"").length>a+2?e.substring(0,a+3)+"亿":e.substring(0,a+2)+"0亿"}}))}),window.define("pages/login/verify_cell",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../utils/util"),y=(m(w),t("../../network/api")),v=m(y),D=t("../../utils/const.js"),x=(m(D),t("../../utils/notification.js")),b=(m(x),t("../../dist/index"));Page(Object.assign({},b.TopTips,{data:{loading:!1,verify:!1,count:60,countDown:!1},onLoad:function(t){var e=t.mobile,a=t.fomatMobile;this.setData({mobile:e,fomatMobile:a})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},getCode:function(t){var e=this;if(console.log(this.data.mobile),!this.data.loading&&!this.data.countDown){i.showLoading({title:"请稍候"}),this.setData({loading:!0,countDown:!0});var a=this,o={mobile:this.data.mobile};v.default.getVerifyCode(o).then(function(t){i.hideLoading(),e.setData({loading:!1}),i.stopPullDownRefresh(),t.data.result?a.setCount():e.showZanTopTips("获取验证码失败")}).catch(function(t){console.log(t),i.hideLoading(),e.setData({loading:!1})})}},setCount:function(){var t=this.data,e=t.count,a=t.mobile,o=this;if(0==e)return void this.setData({verify:!0,mobile:a,count:60,countDown:!1});var i=e-1;this.setData({count:i}),setTimeout(function(){o.setCount()},1e3)},formSubmit:function(t){var e=this;console.log(t.detail.value);var a=t.detail.value,o=void 0;if(!a.verifyCode||0==a.verifyCode.trim().length)return o="验证码不能为空",void this.showZanTopTips(o);v.default.checkVerifyCode({verifyCode:a.verifyCode}).then(function(t){i.stopPullDownRefresh(),console.log("bingooooooooooooo",t),t.data.result?i.redirectTo({url:"/pages/login/login?type=rebind"}):e.showZanTopTips("验证码不正确")}).catch(function(t){return console.log(t)})}}))}),window.define("pages/cards/receive_card/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../network/api"),y=m(w),v=t("../../../dist/index"),D=m(v),x=t("../../../utils/util"),b=m(x),T={data:{isPaying:!1}};b.default.registComp(T,D.default.Toast,{onLoad:function(t){this.setData({id:t.id})},onShow:function(){var t=this.data.id,e=this;i.showLoading({title:"加载中"}),setTimeout(function(){e.querycarddetail({id:t})},2e3);var a=i.getStorageSync("userinfo");this.setData({userinfo:a})},show:function(){var t=this.selectComponent("#popup");t&&t.show()},onTapReceiveCard:function(){var t=this,e=i.getStorageSync("userinfo");this.setData({userinfo:e}),e.mobile?(i.showLoading({title:"加载中"}),y.default.receiveCard({id:this.data.id}).then(function(e){i.hideLoading(),console.log(e),t.showZanToast("领取成功"),t.querycarddetail({id:t.data.id})}).catch(function(e){"222000226"==e.error?t.showZanToast(e.errorMessage):t.showZanToast(y.default.errors(e.error)||"网络链接错误"),t.querycarddetail({id:t.data.id})})):this.setData({showModal:!0,url:"/pages/login/login"})},querycarddetail:function(t){var e=this;i.showLoading({title:"加载中"}),y.default.queryCardDetail(t).then(function(t){console.log(t,"+_+_+_+_+_+_+"),i.hideLoading(),e.setData({carddata:t.data,isShow:!0}),2==t.data.del&&e.show()}).catch(function(t){return console.log(t)})},showToast:function(t){this.showZanToast(t)},onToBuyCard:function(){var t=this;if(!this.data.isPaying){this.setData({isPaying:!0});var e=i.getStorageSync("userinfo");this.setData({userinfo:e}),e.mobile?(i.showLoading({title:"加载中"}),y.default.queryCardToBuy({cardId:this.data.carddata.id}).then(function(e){i.hideLoading(),0==e.status&&i.requestPayment({timeStamp:e.data.timeStamp+"",nonceStr:e.data.nonceStr,package:e.data.package,signType:e.data.signType,paySign:e.data.paySign,success:function(){t.setData({isPaying:!1}),i.redirectTo({url:"/pages/cards/result/index?id="+t.data.carddata.id+"&result=1"})},fail:function(){t.setData({isPaying:!1})}})}).catch(function(e){t.setData({isPaying:!1}),console.log(e,"-----------"),i.hideLoading()})):this.setData({showModal:!0,url:"/pages/login/login"})}}}),Page(T)}),window.define("pages/cards/result/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{},onLoad:function(t){this.setData({result:t.result,id:t.id})},onTapResultAction:function(){i.redirectTo({url:"/pages/cards/receive_card/index?id="+this.data.id})},onTapResultActionExt:function(){i.navigateBack()}})}),window.define("pages/coupons/receive_coupon/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../network/api"),y=m(w),v=t("../../../dist/index"),D=m(v);Page(Object.assign({},D.default.Toast,{data:{},onLoad:function(t){var e=t.id;this.setData({id:e}),t.isdetail&&this.setData({isdetail:!0}),t.color&&this.setData({couponcolor:t.color})},onShow:function(){var t=this.data.id,e=this;i.showLoading({title:"加载中"}),setTimeout(function(){e.queryCouponDetail({id:t})},1e3);var a=i.getStorageSync("userinfo");this.setData({userinfo:a})},receiveCoupon:function(t){var e=this,a=i.getStorageSync("userinfo");this.setData({userinfo:a}),a.mobile?(i.showLoading({title:"加载中"}),y.default.receiveCoupon({id:this.data.id}).then(function(t){i.hideLoading(),e.showZanToast("领取成功"),e.queryCouponDetail({id:e.data.id})}).catch(function(t){i.hideLoading(),e.showZanToast(y.default.errors(t.error)||"网络链接错误")})):this.setData({showModal:!0,url:"/pages/login/login"})},queryCouponDetail:function(t){var e=this;y.default.queryCouponDetail(t).then(function(t){i.hideLoading(),e.setData({coupondetail:t.data,isShow:!0}),console.log(t,"+_+_+_+_")}).catch(function(t){return console.log(t,"++++++++++++")})},showToast:function(t){this.showZanToast(t)},showStoreList:function(){this.setData({isShowStoreList:!0})},toggleStoreDialog:function(){this.setData({isShowStoreList:!1})}}))}),window.define("pages/page/products/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{},onLoad:function(t){},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){}})}),window.define("pages/tuan/mytuan/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var y=t("../../../network/api.js"),v=m(y),D=t("../../../utils/util.js"),x=m(D);Page({data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:10}},onLoad:function(t){this.queryMyTuanList(this.data.query,!0)},startCount:function(){var t=this,e=this,a=this.data.mytuanList,o=void 0===a?[]:a;o.forEach(function(e,a){t.setData(w({},"mytuanList["+a+"].leftTime",x.default.renderTimer(e.remainTime)))}),o.length>0&&(this.stopCount(),this.timer=setInterval(function(){o.forEach(function(t,a){var o,i=t.remainTime-1;0==i&&e.setData(w({},"mytuanList["+a+"].status",3)),e.setData((o={},w(o,"mytuanList["+a+"].remainTime",i),w(o,"mytuanList["+a+"].leftTime",x.default.renderTimer(i)),o))})},1e3))},stopCount:function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},onUnload:function(){this.stopCount()},queryMyTuanList:function(t,e){var a=this;i.showLoading({title:"请稍后"}),v.default.queryMyTuanList(t).then(function(t){console.log(t,"++++"),i.hideLoading(),a.setData({mytuanList:e?t.data.data:a.data.mytuanList.concat(t.data.data),loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}),isShow:!0}),console.log(t,"++++++++++++"),a.startCount()}).catch(function(t){console.log(t),i.hideLoading()})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryMyTuanList(Object.assign({},this.data.query),!1))}})}),window.define("pages/tuan/detail/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var y=t("../../../network/api.js"),v=m(y),D=t("../../../utils/util.js"),x=m(D),b=t("../../../component/cart_popup/index.js"),T=m(b),C=t("../../../dist/index"),S={};x.default.registComp(S,T.default,C.TopTips,{data:{},onLoad:function(t){var e=t.id,a=n().globalData.userinfo;this.setData({userinfo:a}),i.showLoading({title:"请稍后"}),this.queryTuanDetail(e)},onUnload:function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},queryTuanDetail:function(t){var e=this;v.default.queryOpenTuanDetail({id:t}).then(function(t){var a=t.data;i.hideLoading(),e.setData({detail:a}),1==a.status&&console.log("bingo"),a.remainTime>0&&e.startCount()}).catch(function(t){console.log(t),i.hideLoading()})},queryTuanGoodsSku:function(){var t=this,e=n().globalData.userinfo;if(!e||!e.mobile)return void this.setData({showModal:!0,url:"/pages/login/login"});var a=this.data.detail;i.showLoading({title:"请稍后"}),v.default.queryTuanGoodsSku({id:a.id}).then(function(e){i.hideLoading();var o=e.data,n=o.stock,s=o.goodsItem,r=o.goodsSku;t.setData({"currentGood.id":a.goodsId,"currentGood.name":a.goodsName,"currentGood.imgUrl":a.imgUrl,"currentGood.price":a.groupPrice,"currentGood.stock":n,"currentGood.num":1,"currentGood.specs":s,"currentGood.skus":r,"currentGood.selectedSpec":new Array(s.length),"currentGood.selectedSpecValue":"","currentGood.selectedSku":void 0,showDialog:!0})}).catch(function(t){i.hideLoading(),console.log(t)})},startCount:function(){var t=this,e=this.data.detail;this.setData(w({},"detail.leftTime",x.default.renderTimer(e.remainTime)));var a=this;this.timer=setInterval(function(){var o;if(0==e.remainTime)return clearInterval(t.timer),void a.setData(w({},"detail.status",3));var i=e.remainTime-1;a.setData((o={},w(o,"detail.remainTime",i),w(o,"detail.leftTime",x.default.renderTimer(i)),o))},1e3)},handleBuy:function(t){var e=t.currentTarget.dataset.type;this.setData({openType:e}),this.queryTuanGoodsSku()},handleCreateTuan:function(t){var e=this;console.log("e--\x3e",t);var a=this.data,o=a.openType,n=a.detail,s=t.detail,r={};"join"==o?r.sponsorId=n.id:r.groupId=n.groupId,i.showLoading({title:"请稍候"}),v.default.checkoutSingleOrder(Object.assign({goodsId:s.id,propertiesId:s.selectedSku&&s.selectedSku.propertiesId?s.selectedSku.propertiesId:0,num:s.num,consigneeId:-1},r)).then(function(t){i.hideLoading();var e=t.data;i.navigateTo({url:"/pages/orders/new/new?order="+x.default.stringify(e)})}).catch(function(t){console.log("err----\x3e",t),"100001"==t.error?e.showZanTopTips(t.errorMessage||"网络链接错误"):e.showZanTopTips("订单提交失败"),i.hideLoading()})},onShareAppMessage:function(){var t=this.data,e=t.detail,a=t.userinfo;return{title:"["+e.limitPeople+"人团]"+e.goodsName,path:"/pages/tuan/detail/index?id="+e.id+"&shareCode="+a.shareCode}}}),Page(S)}),window.define("component/address_picker/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var w=t("../../network/api.js"),y=function(t){return t&&t.__esModule?t:{default:t}}(w);Page({data:{},onLoad:function(t){var e=t.provinceCode,a=t.cityCode,o=t.districtCode,n=t.level,s=void 0===n?3:n,r=t.action,d=void 0===r?"default":r,u=t.formId,c=t.fieldIndex;this.setData({provinceCode:e,cityCode:a,districtCode:o,level:s,action:d,formId:u,fieldIndex:c}),i.showLoading({title:"请稍后"}),this.queryAreas("provinces",{parentId:"-1"})},queryAreas:function(t,e){var a=this;this.setData({current:t}),("freeQuote"===this.data.action?y.default.queryQuoteRegions(Object.assign({},e,{type:t})):y.default.queryRegions(e)).then(function(e){i.hideLoading(),a.setData(m({},""+t,e.data)),0==e.data.length&&a.back()}).catch(function(){i.hideLoading()})},beginAnim:function(){var t=i.createAnimation({duration:200,timingFunction:"linear",delay:0});this.animation=t,t.translateX(-750).step(),this.setData({animationData:t.export()})},handleProvinceTap:function(t){var e=this.data.level,a=t.currentTarget.dataset.province;this.setData({province:a,provinceCode:a.code}),1==e?this.back():(i.showLoading({title:"请稍后"}),this.queryAreas("cities",{parentId:a.code}))},handleCityTap:function(t){var e=this.data.level,a=t.currentTarget.dataset.city;this.setData({city:a,cityCode:a.code}),2==e?this.back():(i.showLoading({title:"请稍后"}),this.queryAreas("districts",{parentId:a.code}))},handleDistrictTap:function(t){var e=t.currentTarget.dataset.district;this.setData({district:e,districtCode:e.code}),this.back()},back:function(){var t=this.data,e=t.action,a=t.province,o=void 0===a?{}:a,s=t.city,r=void 0===s?{}:s,d=t.district,u=void 0===d?{}:d,c=t.formId,l=t.fieldIndex;if(n().setFlash("address",{province:o,city:r,district:u}),i.navigateBack(),"customForm"==e){var h=getCurrentPages(),g=h[h.length-2];console.log("formId-fieldIndex",c,l);var f=g.selectComponent("#modules").selectAllComponents("#cForm"),p={city:""+(o.fullName||"")+(r.fullName||"")+(u.fullName||""),code:((o.code||0)+","+(r.code||0)+","+(u.code||0)).split(",").filter(function(t){return 0!=t}).join(",")},m=void 0;f.forEach(function(t){c==t.data.formId&&(m=t)}),m&&m.handleSelectAddressResult(l,p)}}})}),window.define("pages/supplys/supplys",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../component/supply/supply"),y=m(w),v=t("../../utils/util"),D=m(v),x=t("../../dist/index"),b={data:{}};D.default.registComp(b,y.default,x.TopTips,{}),Page(b)}),window.define("pages/manjian/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:10},list:[]},onLoad:function(t){t&&this.setData({query:Object.assign({},this.data.query,{dsId:t.dsId,location:t.location,dataType:t.dataType})}),this.queryManjianData(this.data.query,!0)},onShow:function(){},queryManjianData:function(t,e){var a=this;w.default.queryManjianList(t).then(function(t){a.setData({list:e?t.data.data:a.data.list.concat(t.data.data),isShow:!0,loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize})})}).catch(function(t){console.log(t)})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(console.log(t),this.setData({loadingmore:!0}),this.queryManjianData(this.data.query,!1))}})}),window.define("pages/zhaomu/register",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({onLoad:function(){i.redirectTo({url:"/pages/fenxiao/center/index?from=off"})}})}),window.define("pages/pingjia/myevaluate/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../../network/api.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:3}},onLoad:function(t){this.setData({sType:t.sType}),this.queryMyEvaluate(Object.assign({},this.data.query),!0)},queryMyEvaluate:function(t,e){var a=this;i.showLoading({title:"请稍后"}),w.default.queryMyEvaluate(t).then(function(t){i.hideLoading(),a.setData({evaluateData:e?t.data:Object.assign({},a.data.evaluateData,{data:a.data.evaluateData.data.concat(t.data.data)}),loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}),isShow:!0})}).catch(function(t){return console.log(t)})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryMyEvaluate(Object.assign({},this.data.query),!1))}}),Page({})}),window.define("pages/pingjia/productevaluate/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{query:{pageNo:1,pageSize:5,status:-1,sType:""},pingjiaArray:[{name:"全部",num:0,type:"reviewsNum"},{name:"好评",num:0,type:"goodReviewsNum"},{name:"中评",num:0,type:"middleReviewsNum"},{name:"差评",num:0,type:"badReviewsNum"},{name:"有图",num:0,type:"imgReviewsNum"}]},onLoad:function(t){var e=this;this.setData({"query.sType":t.sType,"query.sid":t.sid,"query.storeId":t.storeId}),this.queryEvaluateList(this.data.query,!0),this.setData({pingjiaArray:this.data.pingjiaArray.map(function(t){return Object.assign({},t,{num:e.data.evaluateData[""+t.type]})})})},queryEvaluateList:function(t,e){var a=this;i.showLoading({title:"请稍后"}),w.default.queryEvaluateList(t).then(function(t){i.hideLoading(),a.setData({evaluateData:e?t.data:Object.assign({},a.data.evaluateData,{data:a.data.evaluateData.data.concat(t.data.data)}),loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}),isShow:!0,scrollTop:e?0:void 0,pingjiaArray:a.data.pingjiaArray.map(function(e){return Object.assign({},e,{num:t.data[""+e.type]})})})}).catch(function(t){return console.log(t)})},lower:function(t){console.log(this.data.loadmore,!this.data.loadingmore,"+++++++++++++++++"),this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryEvaluateList(Object.assign({},this.data.query),!1))},evaluateTab:function(t){var e=t.detail,a=(e.currentType,e.evaluate);console.log(t.detail,"........................."),this.setData({"query.status":a}),this.queryEvaluateList(Object.assign({},this.data.query,{pageNo:1}),!0)}}),Page({})}),window.define("pages/pingjia/storeevaluate/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../../network/api"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{toggle:!0,loadmore:!1,loadingmore:!1,query:{pageNo:1,pageSize:2,status:-1},pingjiaArray:[{name:"全部",num:0,type:"reviewsNum"},{name:"好评",num:0,type:"goodReviewsNum"},{name:"中评",num:0,type:"middleReviewsNum"},{name:"差评",num:0,type:"badReviewsNum"},{name:"有图",num:0,type:"imgReviewsNum"}]},onLoad:function(t){t.id&&(this.setData({id:t.id,"query.status":t.status||-1}),i.showLoading({title:"加载中"})),t&&t.openevaluate&&this.setData({openevaluate:t.openevaluate}),1==this.data.openevaluate&&this.queryStoreEvaluate(this.data.query,!0)},queryStoreEvaluate:function(t,e){var a=this;i.showLoading({title:"请稍后"}),w.default.queryStoreEvaluate(Object.assign({},t,{storeId:this.data.id})).then(function(t){i.hideLoading(),a.setData({storeEvaluateData:e?t.data:Object.assign({},a.data.storeEvaluateData,{data:a.data.storeEvaluateData.data.concat(t.data.data)}),loadmore:t.data.nextCursor>0,loadingmore:!1,query:Object.assign({},a.data.query,{pageNo:t.data.nextCursor,pageSize:t.data.pageSize}),isShow:!0,scrollTop:e?0:null,pingjiaArray:a.data.pingjiaArray.map(function(e){return Object.assign({},e,{num:t.data[""+e.type]})})})}).catch(function(t){return console.log(t)})},lower:function(){this.data.loadmore&&!this.data.loadingmore&&(this.setData({loadingmore:!0}),this.queryStoreEvaluate(Object.assign({},this.data.query),!1))},evaluateTab:function(t){var e=t.detail.evaluate;this.setData({"query.status":e}),this.queryStoreEvaluate(this.data.query,!0)},onTapPic:function(t){var e=t.currentTarget.dataset,a=e.imgindex,o=e.type,n=e.index;i.previewImage({current:t.currentTarget.dataset.link,urls:"first"==o?this.data.storeEvaluateData.data[n].evaluates[a].firstEvaluateImgs:this.data.storeEvaluateData.data[n].evaluates[a].secondEvaluateImgs})}}),Page({})}),window.define("pages/pingjia/storeevaluatelist/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{},onLoad:function(){}})}),window.define("pages/pingjia/evaluateform/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var y=t("../../../network/api.js"),v=m(y),D=t("../../../dist/index"),x=m(D);Page(Object.assign({},x.default.TopTips,x.default.Toast,{data:{evaluateItems:[{title:"好评",index:1},{title:"中评",index:2},{title:"差评",index:3}],isBtn:!0},onLoad:function(t){var e=this;this.setData({orderNo:t.orderNo,type:t.type,id:t.id}),i.showLoading(),v.default.gotoEvaluate({orderNo:this.data.orderNo,type:this.data.type,id:this.data.id?this.data.id:0}).then(function(t){i.hideLoading(),t.data.info.length<=0?(console.log("kkkkkkkkkkkkkkkkkkkkkkkkkkkkk"),e.setData({evaluateFormData:Object.assign({},t.data,{info:[{evaluate:"",firstEvaluateContent:"",secondEvaluateContent:"",firstEvaluateImgs:[],secondEvaluateImgs:[],sType:2}]})})):e.setData({evaluateFormData:t.data})}).catch(function(t){return console.log(t)})},radioChange:function(t){console.log("radio发生change事件，携带value值为：",t.detail.value)},formSubmit:function(){for(var t=this,e=this.data.evaluateFormData.info,a=void 0,o=0;o<e.length;o++){if(!e[o].evaluate&&1==this.data.evaluateFormData.evaluateCount&&3!=this.data.type&&5!=this.data.type&&7!=this.data.type){a="请选择评价评级";break}if(!(e[o].firstEvaluateContent||3!=this.data.type&&5!=this.data.type&&5!=this.data.type)){a="请输入评价内容";break}if(!e[o].secondEvaluateContent&&2==this.data.evaluateFormData.evaluateCount){a="请输入评价内容";break}this.data.evaluateFormData.businessScore||1!=this.data.evaluateFormData.evaluateCount||(a="请给商家打分")}if(a)return void this.showZanToast(a);var n=Object.assign({anonymous:0},this.data.evaluateFormData,{evaluates:e.map(function(t){return Object.assign({firstEvaluateContent:"",secondEvaluateContent:""},t,{firstEvaluateImgs:t.firstEvaluateImgs?t.firstEvaluateImgs.join(","):"",secondEvaluateImgs:t.secondEvaluateImgs?t.secondEvaluateImgs.join(","):""})})});delete n.info,this.data.isBtn&&(this.setData({isBtn:!1}),v.default.queryEvaluatePublish(n).then(function(e){t.setData({isBtn:!0}),0==e.status&&e.data.result?(t.showZanToast("发布成功"),i.redirectTo({url:"/pages/pingjia/evaluatesuccess/index?evaluateCount="+t.data.evaluateFormData.evaluateCount})):t.showZanTopTips("发布失败，请重新发布")}).catch(function(e){t.setData({isBtn:!0}),console.log(e,"ooooooooooooooooooooooo"),t.showZanToast(e.errorMessage)}))},handleChooseImg:function(t){console.log("==============handleChooseImg==========");var e=t.currentTarget.dataset.index,a=this,o=void 0;o=1==a.data.evaluateFormData.evaluateCount?a.data.evaluateFormData.info[e].firstEvaluateImgs||[]:a.data.evaluateFormData.info[e].secondEvaluateImgs||[],i.chooseImage({count:5-o.length,sizeType:["compressed"],success:function(t){console.log("==============success==========",t);var o=t.tempFilePaths;console.log(o,"[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[");for(var i=0;i<o.length;i++)v.default.uploadImage(o[i]).then(function(t){if(console.log("============= api.uploadImage==========",t),1==a.data.evaluateFormData.evaluateCount){console.log("ttttttttttttttttttttttttttt");var o=a.data.evaluateFormData.info[e].firstEvaluateImgs,i=void 0===o?[]:o;i.push(t.url),a.setData(w({},"evaluateFormData.info["+e+"].firstEvaluateImgs",i))}else{var n=a.data.evaluateFormData.info[e].secondEvaluateImgs,s=void 0===n?[]:n;s.push(t.url),a.setData(w({},"evaluateFormData.info["+e+"].secondEvaluateImgs",s))}}).catch(function(t){console.log("chooseimage",t)})},fail:function(){}})},handleRemoveImg:function(t){var e=t.currentTarget.dataset,a=e.index,o=e.imgindex;console.log(a,"index");var i=this.data.evaluateFormData.info[a],n=i.firstEvaluateImgs,s=i.secondEvaluateImgs;1==this.data.evaluateFormData.evaluateCount?(n.splice(o,1),this.setData(w({},"evaluateFormData.info["+a+"].firstEvaluateImgs",n))):(s.splice(o,1),this.setData(w({},"evaluateFormData.info["+a+"].secondEvaluateImgs",s)))},onTapPic:function(t){var e=t.currentTarget.dataset,a=e.index,o=e.imgindex,n=this.data.evaluateFormData.info[a],s=n.firstEvaluateImgs,r=n.secondEvaluateImgs;console.log("e--\x3e",t),i.previewImage({current:s?s[o]:r[o],urls:s||r})},onSwitch:function(t){var e=t.detail.value;console.log("onSwitch-----checked--=------\x3e",e),this.setData({"evaluateFormData.anonymous":e?1:0})},onEvaluateType:function(t){console.log("+++++++++");var e=t.currentTarget.dataset,a=e.type,o=e.index;this.setData(w({},"evaluateFormData.info["+o+"].evaluate",a))},onChangeValue:function(t){var e=t.currentTarget.dataset.index,a=t.detail.value;1==this.data.evaluateFormData.evaluateCount?this.setData(w({},"evaluateFormData.info["+e+"].firstEvaluateContent",a)):this.setData(w({},"evaluateFormData.info["+e+"].secondEvaluateContent",a))},evaluateScroe:function(t){var e=t.currentTarget.dataset.item;this.setData({"evaluateFormData.businessScore":e})}}))}),window.define("pages/pingjia/evaluatesuccess/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";Page({data:{},onLoad:function(t){this.setData({evaluateCount:t.evaluateCount})},onShow:function(){}})}),window.define("pages/agreement/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";var m=t("../../utils/util.js"),w=function(t){return t&&t.__esModule?t:{default:t}}(m);Page({data:{},onLoad:function(t){console.log(t,"kkkkkkkkkkkkkkkkkkkk"),this.setData({title:w.default.parse(t.title),content:w.default.parse(t.content)})}})}),window.define("pages/cutprice/detail/index",function(t,e,a,o,i,n,s,r,d,u,c,l,h,g,f,p){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var w=t("../../../network/api"),y=m(w),v=t("../../../utils/util.js"),D=t("../../../utils/notification.js"),x=m(D),b=t("../../../utils/const.js"),T=m(b),C=t("../../../dist/index");Page(Object.assign({},C.Toast,{data:{querySuccess:!1,cutPrice:{},leftTime:{hours:0,minutes:0,seconds:0},showPhoneModal:!1,url:!1},onLoad:function(t){var e=this;t.bargainId?this.queryHelpBargain({id:t.bargainId}):this.queryToBargain({id:t.id,storeId:t.storeId}),x.default.register(T.default.action.CUT_PRICE_SUCCESS,this,function(a){console.log("kanjiachenggong====",a.data);var o=e.data.cutPrice;a.data.bargainSponsorId==o.id&&(t.bargainId?e.queryHelpBargain({id:t.bargainId}):e.queryToBargain({id:t.id,storeId:t.storeId}))})},onUnload:function(){clearInterval(this.interval),x.default.remove(T.default.action.CUT_PRICE_SUCCESS,this)},queryHelpBargain:function(t){var e=this;i.showLoading({title:"请稍后"}),y.default.helpBargain(t).then(function(t){i.hideLoading(),t.data.cutResult&&e.showCutFriendModal(),clearInterval(e.interval),e.setData({cutPrice:t.data,querySuccess:!0},e.setTime)}).catch(function(t){e.showZanTopTips(t.errorMessage||t.msg||y.default.errors(t.error)||"网络错误"),i.hideLoading(),e.setData({querySuccess:!1})})},queryToBargain:function(t){var e=this;i.showLoading({title:"请稍后"}),y.default.toBargain(t).then(function(t){i.hideLoading(),t.data.cutResult&&e.showCutSelfModal(),clearInterval(e.interval),e.setData({cutPrice:t.data,querySuccess:!0},e.setTime)}).catch(function(t){e.showZanTopTips(t.errorMessage||t.msg||y.default.errors(t.error)||"网络错误"),i.hideLoading(),e.setData({querySuccess:!1})})},setTime:function(){var t=this,e=this.data.cutPrice;1==e.status&&(this.interval=setInterval(function(){var a=e.timeLeft-1,o=(0,v.renderTimer)(a),i=24*parseInt(o.days)+parseInt(o.hours);t.setData({"cutPrice.timeLeft":a,leftTime:Object.assign({},o,{hours:i<9?"0"+i:i})})},1e3))},onShareAppMessage:function(){var t=["【最后1小时】帮我点一下，和我一起0元免费拿吧↓↓↓","【好友@我】朋友一声吼，砍价有木有↓↓↓","帮我砍价！你也有机会直接拿走商品↓↓↓","【好友@我】砍砍砍，砍至最低↓↓↓"];return{title:t[Math.floor(Math.random()*t.length)],imageUrl:this.data.cutPrice.imgs,path:"/pages/cutprice/detail/index?bargainId="+this.data.cutPrice.id}},showHelpModal:function(){var t=this.selectComponent("#help-modal");t&&t.show()},showCutSelfModal:function(){var t=this.selectComponent("#cut-modal-self");t&&t.show()},showCutFriendModal:function(){var t=this.selectComponent("#cut-modal-friend");t&&t.show()},friendCutPrice:function(){var t=this.data.cutPrice;this.queryToBargain({id:t.bargainId,storeId:t.storeId})},gopay:function(){var t=this,e=this.data.cutPrice;if(!i.getStorageSync("userinfo").mobile)return void this.setData({showPhoneModal:!0,url:"/pages/login/login"});1==e.type?(i.showLoading({title:"请稍后"}),y.default.checkoutSingleOrder({goodsId:e.goodsId,propertiesId:"",num:1,consigneeId:-1,bargainSponsorId:e.id}).then(function(t){i.hideLoading();var e=t.data;i.navigateTo({url:"/pages/orders/new/new?order="+(0,v.stringify)(e)})}).catch(function(e){t.showZanTopTips(e.errorMessage||e.msg||y.default.errors(e.error)||"网络错误"),i.hideLoading()})):2==e.type&&(n().setFlash("service",{storeId:e.storeId,id:e.service.id,serviceName:e.service.serviceName,servicePrice:e.bargainPrice,serviceImg:e.imgs,selectedSku:{},selectedSpecValue:""}),i.navigateTo({url:"/pages/services/order_create/index?bargainSponsorId="+e.id}))}}))}),window.__swanRoute="tabs/home/index",window.usingComponents=["component/page/index","dist/minui/wxc-abnor/dist/index","component/home_gift_popup/index","dist/minui/wxc-icon/dist/index","component/phone_action/index"],require("tabs/home/index"),window.__swanRoute="tabs/mine/index",window.usingComponents=["component/phonemodal/phonemodal","component/phone_action/index"],require("tabs/mine/index"),window.__swanRoute="tabs/order/index",window.usingComponents=["component/phonebutton/index","dist/minui/wxc-dialog/dist/index","dist/minui/wxc-elip/dist/index"],require("tabs/order/index"),window.__swanRoute="tabs/about/index",window.usingComponents=[],require("tabs/about/index"),window.__swanRoute="tabs/map/index",window.usingComponents=[],require("tabs/map/index"),window.__swanRoute="tabs/brandlist/index",window.usingComponents=[],require("tabs/brandlist/index"),window.__swanRoute="tabs/custome/custome",window.usingComponents=["component/page/index"],require("tabs/custome/custome"),window.__swanRoute="tabs/carts/index",window.usingComponents=["component/phonebutton/index"],require("tabs/carts/index"),window.__swanRoute="tabs/publish/index",window.usingComponents=["component/phonemodal/phonemodal"],require("tabs/publish/index"),window.__swanRoute="tabs/supplyBuy/index",window.usingComponents=[],require("tabs/supplyBuy/index"),window.__swanRoute="tabs/info/index",window.usingComponents=["component/newsinfo/newsinfo"],require("tabs/info/index"),window.__swanRoute="tabs/fenxiao/index",window.usingComponents=["component/phonemodal/phonemodal","dist/minui/wxc-popup/dist/index"],require("tabs/fenxiao/index"),window.__swanRoute="tabs/giftCard/index",window.usingComponents=[],require("tabs/giftCard/index"),window.__swanRoute="tabs/goodsCategory/index",window.usingComponents=["component/category/index"],require("tabs/goodsCategory/index"),window.__swanRoute="tabs/company/index",window.usingComponents=["component/decoration_company/index"],require("tabs/company/index"),window.__swanRoute="tabs/picture/index",window.usingComponents=["component/decoration_picture/index"],require("tabs/picture/index"),window.__swanRoute="tabs/designer/index",window.usingComponents=["component/decoration_designer/index"],require("tabs/designer/index"),window.__swanRoute="tabs/live/index",window.usingComponents=["component/live/live_page"],require("tabs/live/index"),window.__swanRoute="modules/map/index",window.usingComponents=[],require("modules/map/index"),window.__swanRoute="modules/custome/custome",window.usingComponents=["component/page/index"],require("modules/custome/custome"),window.__swanRoute="pages/webview/index",window.usingComponents=[],require("pages/webview/index"),window.__swanRoute="pages/addressdetail/addressdetail",window.usingComponents=["component/phonemodal/phonemodal"],require("pages/addressdetail/addressdetail"),window.__swanRoute="pages/addresssearch/addresssearch",window.usingComponents=[],require("pages/addresssearch/addresssearch"),window.__swanRoute="pages/citys/citys",window.usingComponents=[],require("pages/citys/citys"),window.__swanRoute="pages/login/login",window.usingComponents=[],require("pages/login/login"),window.__swanRoute="pages/brandlist/index",window.usingComponents=[],require("pages/brandlist/index"),window.__swanRoute="pages/aboutmine/aboutmine",window.usingComponents=[],require("pages/aboutmine/aboutmine"),window.__swanRoute="pages/page/search/search",window.usingComponents=["dist/minui/wxc-search/dist/index","dist/minui/wxc-tab/dist/index","dist/minui/wxc-tab/dist/panel","pages/page/search/product-tab/index","pages/page/search/store-tab/index"],require("pages/page/search/search"),window.__swanRoute="pages/storelist/storelist",window.usingComponents=["dist/minui/wxc-label/dist/index","dist/minui/wxc-toast/dist/index"],require("pages/storelist/storelist"),window.__swanRoute="pages/address/list/list",window.usingComponents=[],require("pages/address/list/list"),window.__swanRoute="pages/address/search/search",window.usingComponents=[],require("pages/address/search/search"),window.__swanRoute="pages/address/new/new",window.usingComponents=[],require("pages/address/new/new"),window.__swanRoute="pages/brandmap/brandmap",window.usingComponents=[],require("pages/brandmap/brandmap"),window.__swanRoute="pages/products/show/show",window.usingComponents=["component/phonemodal/phonemodal","dist/minui/wxc-popup/dist/index","dist/minui/wxc-toast/dist/index","component/phone_action/index"],require("pages/products/show/show"),window.__swanRoute="pages/login/verify_cell",window.usingComponents=[],require("pages/login/verify_cell"),window.__swanRoute="pages/cards/receive_card/index",window.usingComponents=["component/phonemodal/phonemodal","dist/minui/wxc-popup/dist/index"],require("pages/cards/receive_card/index"),window.__swanRoute="pages/cards/result/index",window.usingComponents=["component/phonemodal/phonemodal"],require("pages/cards/result/index"),window.__swanRoute="pages/coupons/receive_coupon/index",window.usingComponents=["component/phonemodal/phonemodal","component/coupon/index"],require("pages/coupons/receive_coupon/index"),window.__swanRoute="pages/page/products/index",window.usingComponents=[],require("pages/page/products/index"),window.__swanRoute="pages/tuan/mytuan/index",window.usingComponents=[],require("pages/tuan/mytuan/index"),window.__swanRoute="pages/tuan/detail/index",window.usingComponents=["component/phonemodal/phonemodal","component/cart_popup/index"],require("pages/tuan/detail/index"),window.__swanRoute="component/address_picker/index",window.usingComponents=[],require("component/address_picker/index"),window.__swanRoute="pages/supplys/supplys",window.usingComponents=[],require("pages/supplys/supplys"),window.__swanRoute="pages/manjian/index",window.usingComponents=[],require("pages/manjian/index"),window.__swanRoute="pages/zhaomu/register",window.usingComponents=[],require("pages/zhaomu/register"),window.__swanRoute="pages/pingjia/myevaluate/index",window.usingComponents=["pages/pingjia/component/evaluatecontent/index","dist/minui/wxc-abnor/dist/index","pages/pingjia/myevaluate/index"],require("pages/pingjia/myevaluate/index"),window.__swanRoute="pages/pingjia/productevaluate/index",window.usingComponents=["pages/pingjia/component/evaluatecontent/index","pages/pingjia/component/evaluateitems/index","dist/minui/wxc-abnor/dist/index","pages/pingjia/productevaluate/index"],require("pages/pingjia/productevaluate/index"),window.__swanRoute="pages/pingjia/storeevaluate/index",window.usingComponents=["pages/pingjia/component/evaluatecontent/index","pages/pingjia/component/evaluateitems/index","dist/minui/wxc-abnor/dist/index","pages/pingjia/storeevaluate/index"],require("pages/pingjia/storeevaluate/index"),window.__swanRoute="pages/pingjia/storeevaluatelist/index",window.usingComponents=[],require("pages/pingjia/storeevaluatelist/index");window.__swanRoute="pages/pingjia/evaluateform/index",window.usingComponents=[],require("pages/pingjia/evaluateform/index"),window.__swanRoute="pages/pingjia/evaluatesuccess/index",window.usingComponents=[],require("pages/pingjia/evaluatesuccess/index"),window.__swanRoute="pages/agreement/index",window.usingComponents=[],require("pages/agreement/index"),window.__swanRoute="pages/cutprice/detail/index",window.usingComponents=["dist/minui/wxc-price/dist/index","pages/cutprice/components/help-modal/index","pages/cutprice/components/cut-modal-self/index","component/phonemodal/phonemodal","pages/cutprice/components/cut-modal-friend/index"],require("pages/cutprice/detail/index");