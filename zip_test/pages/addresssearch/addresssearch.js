window.define("pages/addresssearch/addresssearch",function(t,a,e,o,i,n,s,c,l,u,d,r,f,h,g,y){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}var p=t("../../network/api"),v=m(p),w=t("../../utils/const"),N=m(w),C=t("../../utils/notification"),D=m(C);Page({data:{},onLoad:function(t){var a=this;this.queryCitys();var e=n().globalData.location;console.log(e,"location"),e&&this.setData({cityName:e.cityName}),D.default.register(N.default.action.SEARCH_CITY,this,function(t){console.log("get notiffffffffffffffffffffff",t),a.setData({cityName:t.data})})},changevalue:function(t){console.log(t.detail.value),this.setData({inputValue:t.detail.value})},clearValue:function(){this.setData({inputValue:""})},searchCtiy:function(t){console.log(t.detail.value);var a={cityName:this.data.cityName,keyword:""+t.detail.value};this.queryMap(a)},handleSearch:function(){var t={cityName:this.data.cityName,keyword:this.data.inputValue};this.queryMap(t)},queryMap:function(t){var a=this;i.showLoading({title:"加载中"}),v.default.queryMap(t).then(function(t){i.hideLoading(),i.stopPullDownRefresh(),console.log("bingooooooooooooo",t),a.setData({addresslist:t.data})}).catch(function(t){return console.log(t)})},makeCitys:function(){i.navigateTo({url:"/pages/citys/citys?city="+this.data.cityName+"&from=search"})},queryCitys:function(){var t=this;v.default.getIndexCities().then(function(a){i.stopPullDownRefresh();for(var e=a.data.cityList,o=[],n=0;n<e.length;n++)o=o.concat(e[n].cities);t.data.cityName||t.setData({cityName:o[0]})}).catch(function(t){return console.log(t)})},bindaddress:function(t){console.log("item",t.currentTarget.dataset.item);var a=t.currentTarget.dataset.item,e={latitude:a.location.lat,longitude:a.location.lng,location:a.title,cityName:a.city,addressId:a.id};n().globalData.location=e,i.setStorageSync("location",e),v.default.getUserLocation({latitude:a.location.lat,longitude:a.location.lng,type:0}).then(function(t){D.default.post(N.default.action.LOCATION_CHANGED,e),i.navigateBack()})},onUnload:function(){D.default.remove(N.default.action.SEARCH_CITY,this)}})}),window.__swanRoute="pages/addresssearch/addresssearch",window.usingComponents=[],require("pages/addresssearch/addresssearch");