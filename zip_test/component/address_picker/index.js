window.define("component/address_picker/index",function(e,t,i,a,n,o,d,r,c,s,l,u,f,h,v,p){"use strict";function m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g=e("../../network/api.js"),y=function(e){return e&&e.__esModule?e:{default:e}}(g);Page({data:{},onLoad:function(e){var t=e.provinceCode,i=e.cityCode,a=e.districtCode,o=e.level,d=void 0===o?3:o,r=e.action,c=void 0===r?"default":r,s=e.formId,l=e.fieldIndex;this.setData({provinceCode:t,cityCode:i,districtCode:a,level:d,action:c,formId:s,fieldIndex:l}),n.showLoading({title:"请稍后"}),this.queryAreas("provinces",{parentId:"-1"})},queryAreas:function(e,t){var i=this;this.setData({current:e}),("freeQuote"===this.data.action?y.default.queryQuoteRegions(Object.assign({},t,{type:e})):y.default.queryRegions(t)).then(function(t){n.hideLoading(),i.setData(m({},""+e,t.data)),0==t.data.length&&i.back()}).catch(function(){n.hideLoading()})},beginAnim:function(){var e=n.createAnimation({duration:200,timingFunction:"linear",delay:0});this.animation=e,e.translateX(-750).step(),this.setData({animationData:e.export()})},handleProvinceTap:function(e){var t=this.data.level,i=e.currentTarget.dataset.province;this.setData({province:i,provinceCode:i.code}),1==t?this.back():(n.showLoading({title:"请稍后"}),this.queryAreas("cities",{parentId:i.code}))},handleCityTap:function(e){var t=this.data.level,i=e.currentTarget.dataset.city;this.setData({city:i,cityCode:i.code}),2==t?this.back():(n.showLoading({title:"请稍后"}),this.queryAreas("districts",{parentId:i.code}))},handleDistrictTap:function(e){var t=e.currentTarget.dataset.district;this.setData({district:t,districtCode:t.code}),this.back()},back:function(){var e=this.data,t=e.action,i=e.province,a=void 0===i?{}:i,d=e.city,r=void 0===d?{}:d,c=e.district,s=void 0===c?{}:c,l=e.formId,u=e.fieldIndex;if(o().setFlash("address",{province:a,city:r,district:s}),n.navigateBack(),"customForm"==t){var f=getCurrentPages(),h=f[f.length-2];console.log("formId-fieldIndex",l,u);var v=h.selectComponent("#modules").selectAllComponents("#cForm"),p={city:""+(a.fullName||"")+(r.fullName||"")+(s.fullName||""),code:((a.code||0)+","+(r.code||0)+","+(s.code||0)).split(",").filter(function(e){return 0!=e}).join(",")},m=void 0;v.forEach(function(e){l==e.data.formId&&(m=e)}),m&&m.handleSelectAddressResult(u,p)}}})}),window.__swanRoute="component/address_picker/index",window.usingComponents=[],require("component/address_picker/index");